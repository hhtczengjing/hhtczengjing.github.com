<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>æ›¾é™çš„åšå®¢</title>
    <description>å—¨ï¼Œæˆ‘æ˜¯æ›¾é™ (@devzeng)ï¼Œç›®å‰æš‚å±…æ·±åœ³ã€‚</description>
    <link>http://blog.devzeng.com/</link>
    <atom:link href="http://blog.devzeng.com/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sun, 30 Jun 2019 21:37:21 +0800</pubDate>
    <lastBuildDate>Sun, 30 Jun 2019 21:37:21 +0800</lastBuildDate>
    <generator>Jekyll v3.8.4</generator>
    
      <item>
        <title>å¦‚ä½•å°†è‡ªå·±çš„Node.jsåŒ…å‘å¸ƒåˆ°npmä¸Šé¢</title>
        <description>&lt;p&gt;æ—©å‰å†™è¿‡ä¸€ç¯‡&lt;a href=&quot;https://blog.devzeng.com/blog/npm-repo-with-verdaccio.html&quot;&gt;ã€Šä½¿ç”¨Verdaccioæ­å»ºnpmä»“åº“ã€‹&lt;/a&gt;ä»‹ç»å¦‚ä½•æ­å»ºç§æœ‰çš„npmåŒ…æ‰˜ç®¡çš„ç¯å¢ƒçš„æ–‡ç« ï¼Œæ¯”è¾ƒé€‚åˆå°†ç§æœ‰çš„Node.jsåŒ…å‘å¸ƒä¸Šå»ã€‚æœ¬æ–‡ä¸»è¦è®°å½•ä¸€ä¸‹å‘å¸ƒä¸€ä¸ªå…¬å¼€çš„packageåˆ°npmçš„è¿‡ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/npm-publish-package/npm-intro.png&quot; alt=&quot;npm-intro.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;1ã€æ³¨å†Œè´¦å·&lt;/p&gt;

&lt;p&gt;å‰å¾€&lt;code class=&quot;highlighter-rouge&quot;&gt;https://www.npmjs.com&lt;/code&gt;æ³¨å†Œè´¦å·ï¼Œå¹¶æŒ‰ç…§è¦æ±‚éªŒè¯é‚®ç®±ã€‚&lt;/p&gt;

&lt;p&gt;2ã€Node.jsåŒ…&lt;/p&gt;

&lt;p&gt;åˆ›å»º&lt;code class=&quot;highlighter-rouge&quot;&gt;package.json&lt;/code&gt;æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{
  &quot;name&quot;: &quot;gitlab-systemhook-handler&quot;,
  &quot;version&quot;: &quot;0.1.0&quot;,
  &quot;description&quot;: &quot;Web handler / middleware for processing Gitlab System hooks&quot;,
  &quot;main&quot;: &quot;gitlab-systemhook-handler.js&quot;,
  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;node demo.js&quot;
  },
  &quot;keywords&quot;: [
    &quot;gitlab&quot;,
    &quot;systemhook&quot;
  ],
  &quot;author&quot;: &quot;zengjing &amp;lt;hhtczengjing@gmail.com&amp;gt;&quot;,
  &quot;repository&quot;: {
    &quot;type&quot;: &quot;git&quot;,
    &quot;url&quot;: &quot;https://github.com/hhtczengjing/gitlab-systemhook-handler.git&quot;
  },
  &quot;license&quot;: &quot;MIT&quot;,
  &quot;dependencies&quot;: {
    &quot;bl&quot;: &quot;~1.1.2&quot;,
    &quot;buffer-equal-constant-time&quot;: &quot;~1.0.1&quot;
  }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ï¼ˆ1ï¼‰name: åŒ…çš„åå­—&lt;/li&gt;
  &lt;li&gt;ï¼ˆ2ï¼‰versionï¼šç‰ˆæœ¬å·&lt;/li&gt;
  &lt;li&gt;ï¼ˆ3ï¼‰mainï¼šå…¥å£çš„JSæ–‡ä»¶åç§°&lt;/li&gt;
  &lt;li&gt;ï¼ˆ4ï¼‰repositoryï¼šæºç è·¯å¾„&lt;/li&gt;
  &lt;li&gt;ï¼ˆ5ï¼‰dependenciesï¼šä¾èµ–åº“&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;3ã€ç™»å½•&lt;/p&gt;

&lt;p&gt;å‘½ä»¤è¡Œè¾“å…¥ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;npm login&lt;/code&gt;ï¼Œå¦‚æœè®¾ç½®äº†ç¬¬ä¸‰æ–¹çš„registryï¼Œå¯ä»¥åœ¨åé¢åŠ ä¸Š&lt;code class=&quot;highlighter-rouge&quot;&gt;--registry https://registry.npmjs.com/&lt;/code&gt;ï¼Œç„¶åæŒ‰ç…§è¦æ±‚è¾“å…¥ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±å³å¯å®Œæˆç™»å½•ã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;âœ npm login --registry https://registry.npmjs.com/
Username: zengjing
Password: 
Email: (this IS public) hhtczengjing@gmail.com
Logged in as zengjing on https://registry.npmjs.com/.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;4ã€å‘å¸ƒ&lt;/p&gt;

&lt;p&gt;å‘½ä»¤è¡Œè¾“å…¥ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;npm publish&lt;/code&gt;ï¼ŒåŒä¸Šå¦‚æœè®¾ç½®äº†ç¬¬ä¸‰æ–¹çš„registryï¼Œå¯ä»¥åœ¨åé¢åŠ ä¸Š&lt;code class=&quot;highlighter-rouge&quot;&gt;--registry https://registry.npmjs.com/&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;âœ npm publish --registry https://registry.npmjs.com/
npm notice 
npm notice ğŸ“¦  gitlab-systemhook-handler@0.1.0
npm notice === Tarball Contents === 
npm notice 582B  package.json                
npm notice 762B  demo.js                     
npm notice 2.5kB gitlab-systemhook-handler.js
npm notice 1.3kB README.md                   
npm notice === Tarball Details === 
npm notice name:          gitlab-systemhook-handler               
npm notice version:       0.1.0                                   
npm notice package size:  1.9 kB                                  
npm notice unpacked size: 5.1 kB                                  
npm notice shasum:        115e54761497edeb3187617f6b683f2300f877b4
npm notice integrity:     sha512-zNm/3Tzps0HUJ[...]ZoHOcyTeckDuA==
npm notice total files:   4                                       
npm notice 
+ gitlab-systemhook-handler@0.1.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååˆ°npmçš„åå°å¯ä»¥çœ‹åˆ°å‘å¸ƒæˆåŠŸçš„packageäº†ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/npm-publish-package/packages.png&quot; alt=&quot;packages.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å¦‚æœé‡åˆ°å¦‚ä¸‹çš„é”™è¯¯ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/npm-publish-package/403_error.png&quot; alt=&quot;403_error.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¡¨ç¤ºæ²¡æœ‰éªŒè¯é‚®ç®±ï¼Œè¯·å…ˆåˆ°æ³¨å†Œçš„é‚®ç®±éªŒè¯ï¼Œç„¶åé‡æ–°å‘å¸ƒå³å¯&lt;/p&gt;

&lt;h3 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;å‚è€ƒèµ„æ–™&lt;/h3&gt;

&lt;p&gt;1ã€&lt;a href=&quot;https://blog.csdn.net/zyg1515330502/article/details/81112653&quot;&gt;å¦‚ä½•ä½¿ç”¨npmå‘å¸ƒè‡ªå·±çš„npmåŒ…&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2ã€&lt;a href=&quot;https://www.npmjs.com&quot;&gt;npm å®˜ç½‘&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 31 May 2019 18:46:37 +0800</pubDate>
        <link>http://blog.devzeng.com/blog/publish-npm-package.html</link>
        <guid isPermaLink="true">http://blog.devzeng.com/blog/publish-npm-package.html</guid>
        
        <category>Note</category>
        
        
      </item>
    
      <item>
        <title>åœ¨Dockerä¸Šæ­å»ºWebDAVæ–‡ä»¶å…±äº«æœåŠ¡</title>
        <description>&lt;p&gt;è¿‘æœŸç”±äºä¸€äº›ä¸å¯æŠ—åŠ›å› ç´ å¯¼è‡´AirDropè¢«ç¦ç”¨äº†ï¼Œå¹³æ—¶å¯¹æ–‡æ¡£æˆ–è€…æ˜¯ä¸€äº›å®‰è£…åŒ…çš„å…±äº«è¿˜æ˜¯æœ‰æ¯”è¾ƒå¤šçš„éœ€æ±‚ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ä½¿ç”¨Dockerå¿«é€Ÿæ­å»ºWebDAVç¯å¢ƒçš„è¿‡ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;ç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ä¸‹é¢çš„å‘½ä»¤å³å¯å¿«é€Ÿå®Œæˆå®‰è£…ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker run -d -v /Users/zengjing/docker/webdav:/var/webdav -e USERNAME=test -e PASSWORD=test -p 8888:80 morrisjobke/webdav
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæˆåé€šè¿‡æµè§ˆå™¨ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;http://ip:8888/webdav&lt;/code&gt;è¿›è¡Œè®¿é—®ï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç &lt;code class=&quot;highlighter-rouge&quot;&gt;test/test&lt;/code&gt;å³å¯&lt;/p&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;(1) &lt;code class=&quot;highlighter-rouge&quot;&gt;-v&lt;/code&gt;åé¢çš„è·¯å¾„æ˜¯å…±äº«çš„æ–‡ä»¶å­˜æ”¾çš„è·¯å¾„ï¼Œéœ€è¦æå‰åˆ›å»ºå¥½ã€‚å¯ä»¥ç›´æ¥å°†éœ€è¦å…±äº«çš„æ–‡ä»¶æ‹·è´åˆ°è¯¥ç›®å½•ä¸‹é¢å…¶ä»–äººå°±å¯ä»¥ç›´æ¥è¿›è¡Œä¸‹è½½ä½¿ç”¨&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;(2) &lt;code class=&quot;highlighter-rouge&quot;&gt;USERNAMEã€PASSWORD&lt;/code&gt;åˆ†åˆ«æ˜¯ç”¨æˆ·åå¯†ç &lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å¦‚æœå…¶ä»–ç”µè„‘æƒ³è¦ä¸Šä¼ æ–‡ä»¶åˆ°å…±äº«ç›˜ä¸Šé¢å¯ä»¥é€šè¿‡ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Finder -&amp;gt; å‰å¾€ -&amp;gt; è¿æ¥æœåŠ¡å™¨&lt;/code&gt;ï¼Œåœ¨å¯¹è¯æ¡†ä¸­è¾“å…¥: &lt;code class=&quot;highlighter-rouge&quot;&gt;http://ç”¨æˆ·å:å¯†ç @IP:ç«¯å£/webdav&lt;/code&gt;å°±å¯ä»¥å°†å…±äº«ç›˜æŒ‚è½½åˆ°æœ¬åœ°ï¼Œç„¶ååƒè®¿é—®æœ¬åœ°ç£ç›˜æ–‡ä»¶å¤¹ä¸€æ ·ç›´æ¥å°†éœ€è¦å…±äº«çš„å†…å®¹å¤åˆ¶è¿›å»å³å¯ã€‚&lt;/p&gt;
</description>
        <pubDate>Mon, 25 Feb 2019 18:46:37 +0800</pubDate>
        <link>http://blog.devzeng.com/blog/build-webdav-server-in-docker.html</link>
        <guid isPermaLink="true">http://blog.devzeng.com/blog/build-webdav-server-in-docker.html</guid>
        
        <category>Note</category>
        
        
      </item>
    
      <item>
        <title>åœ¨Dockerä¸Šæ­å»ºåœ¨çº¿è¡¨æ ¼æœåŠ¡</title>
        <description>&lt;p&gt;å·¥ä½œä¸­æ€»å°‘ä¸äº†éœ€è¦å¡«å†™è¡¨æ ¼çš„æƒ…å†µï¼Œç‰¹åˆ«æ˜¯å¯¹äºä¸€äº›éœ€è¦æ”¶é›†ä¿¡æ¯(æ¯”å¦‚ä½å€å’Œå·ç )çš„è¡¨æ ¼ï¼Œæœ€è¿‘å‘ç°äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„å·¥å…·&lt;a href=&quot;http://cn.ethercalc.net/&quot;&gt;ethercalc&lt;/a&gt;, å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ­å»ºå‡ºå¤šäººåä½œçš„åœ¨çº¿è¡¨æ ¼æœåŠ¡ï¼Œè€Œä¸”ç”¨æ³•å’ŒExcelä¸€è‡´ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/ethercalc-docker/hello-ethercalc.png&quot; alt=&quot;hello-ethercalc.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸‹é¢è®°å½•ä¸€ä¸‹å¦‚ä½•å¿«é€Ÿæ­å»ºçš„è¿‡ç¨‹ï¼š&lt;/p&gt;

&lt;p&gt;(1) å®‰è£…redis&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker run --name redis -d -v /Users/zengjing/docker/redis:/data redis:latest redis-server --appendonly yes
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(2) å®‰è£…ethercalc&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker run -d -p 8000:8000 --link redis:redis --restart=always audreyt/ethercalc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæˆä¹‹åï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥&lt;code class=&quot;highlighter-rouge&quot;&gt;http://localhost:8000&lt;/code&gt;å³å¯ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/ethercalc-docker/overview-ethercalc.png&quot; alt=&quot;hello-ethercalc.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(3) å¿«é€Ÿåˆ›å»º&lt;/p&gt;

&lt;p&gt;æ”¯æŒç›´æ¥å°†Excelæ‹–æ‹½ä¸Šå»å¿«é€Ÿåˆ›å»ºï¼Œå¦å¤–ä¹Ÿæ”¯æŒé€šè¿‡æµè§ˆå™¨è¾“å…¥ä¸€ä¸ªåœ°å€è¿›è¡Œåˆ›å»ºï¼Œæ¯”å¦‚æƒ³åˆ›å»ºä¸€ä¸ªåå­—å«åš&lt;code class=&quot;highlighter-rouge&quot;&gt;demo&lt;/code&gt;çš„æ–‡æ¡£ï¼Œç›´æ¥è¾“å…¥&lt;code class=&quot;highlighter-rouge&quot;&gt;http://localhost:8000/demo&lt;/code&gt;ç«‹å³åˆ›å»ºå®Œæˆï¼Œå¹¶ä¸”å¯ä»¥å°†è¯¥æ–‡æ¡£é“¾æ¥åœ°å€å‘é€ç»™å…¶ä»–äººè¿›è¡Œå¡«å†™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/ethercalc-docker/fast-create.png&quot; alt=&quot;hello-ethercalc.png&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 11 Jan 2019 18:46:37 +0800</pubDate>
        <link>http://blog.devzeng.com/blog/build-online-excel-in-docker.html</link>
        <guid isPermaLink="true">http://blog.devzeng.com/blog/build-online-excel-in-docker.html</guid>
        
        <category>Note</category>
        
        
      </item>
    
      <item>
        <title>Dockerå®‰è£…MySQLæ•°æ®åº“</title>
        <description>&lt;p&gt;è¿‘æœŸç»å¸¸éœ€è¦å®‰è£…MySQLæ•°æ®åº“ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;1ã€åˆå§‹åŒ–åˆ›å»ºæ–‡ä»¶å¤¹&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mkdir -p ~/docker/mysql/conf/
mkdir -p ~/docker/mysql/data
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ã€åœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;conf&lt;/code&gt;ç›®å½•ä¸‹åˆ›å»ºé…ç½®æ–‡ä»¶&lt;code class=&quot;highlighter-rouge&quot;&gt;my.cnf&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[mysqld]
character-set-server=utf8
[client]
default-character-set=utf8
[mysql]
default-character-set=utf8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3ã€å®‰è£…&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker run -d -p 3306:3306 \
    --privileged=true \
    --restart=always \
    -v /Users/zengjing/docker/mysql/conf/my.cnf:/etc/mysql/my.cnf \
    -v /Users/zengjing/docker/mysql/data:/var/lib/mysql \
    -e MYSQL_ROOT_PASSWORD=&quot;123456&quot; \
    --name mysql57 \
    mysql:5.7
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å‚æ•°è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;(1) -d (Detached)è¡¨ç¤ºå®¹å™¨å°†ä»¥åå°æ¨¡å¼è¿è¡Œï¼Œæ‰€æœ‰I/Oæ•°æ®åªèƒ½é€šè¿‡ç½‘ç»œèµ„æºæˆ–è€…å…±äº«å·ç»„æ¥è¿›è¡Œäº¤äº’ã€‚&lt;/li&gt;
  &lt;li&gt;(2) -p 127.0.0.1:3306:3306å°†ä¸»æœºï¼ˆ127.0.0.1ï¼‰çš„ç«¯å£ 3306 æ˜ å°„åˆ°å®¹å™¨çš„ç«¯å£ 3306 ä¸­ã€‚è¿™æ ·è®¿é—®ä¸»æœºä¸­çš„ 3306 ç«¯å£å°±ç­‰äºè®¿é—®å®¹å™¨ä¸­çš„ 3306 ç«¯å£ã€‚&lt;/li&gt;
  &lt;li&gt;(3) â€“name mysql57ç»™å®¹å™¨å–åä¸º mysql57ï¼Œè¿™æ ·æ–¹ä¾¿è®°å¿†ã€‚&lt;/li&gt;
  &lt;li&gt;(4) -v /Users/zengjing/docker/mysql/data:/var/lib/mysql å°†æœ¬æœºçš„æ–‡ä»¶ç›®å½•æŒ‚è½½åˆ°å®¹å™¨å¯¹åº”çš„ç›®å½•ï¼ˆ/var/lib/mysqlï¼‰ä¸­ã€‚è¿™æ ·å¯ä»¥é€šè¿‡æ•°æ®å·å®ç°å®¹å™¨ä¸­æ•°æ®çš„æŒä¹…åŒ–ã€‚&lt;/li&gt;
  &lt;li&gt;(6) -e MYSQL_ROOT_PASSWORD=â€111111â€-e è¡¨ç¤ºè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ­¤å¤„è®¾ç½®äº† mysql root ç”¨æˆ·çš„åˆå§‹å¯†ç ä¸º 123456ã€‚&lt;/li&gt;
  &lt;li&gt;(7) mysql:5.7è¡¨ç¤ºä½¿ç”¨ mysql 5.7 å¯åŠ¨ä¸€ä¸ªå®¹å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Thu, 20 Dec 2018 18:46:37 +0800</pubDate>
        <link>http://blog.devzeng.com/blog/install-mysql-in-docker.html</link>
        <guid isPermaLink="true">http://blog.devzeng.com/blog/install-mysql-in-docker.html</guid>
        
        <category>Note</category>
        
        
      </item>
    
      <item>
        <title>Flutterå¼€å‘åˆæ¢</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://flutter.io/&quot;&gt;Flutter&lt;/a&gt;æ˜¯ç”±è°·æ­Œåˆ›å»ºçš„ä¸€ä¸ªæ¡†æ¶ï¼Œç”¨äºæ„å»ºâ€œç°ä»£ç§»åŠ¨åº”ç”¨â€ã€‚ç›®å‰å®ƒè¿˜å¤„äºbetaé˜¶æ®µï¼Œä¸è¿‡å®ƒçš„æ–‡æ¡£å’Œç›¸å…³å·¥å…·ååˆ†é½å…¨ï¼Œæœ‰äº›ç§»åŠ¨åº”ç”¨å·²ç»åœ¨ä½¿ç”¨Flutterã€‚&lt;/p&gt;

&lt;h3 id=&quot;å¼€å‘ç¯å¢ƒæ­å»º&quot;&gt;å¼€å‘ç¯å¢ƒæ­å»º&lt;/h3&gt;

&lt;p&gt;ç”±äºåœ¨å›½å†…è®¿é—®Flutteræœ‰æ—¶å¯èƒ½ä¼šå—åˆ°é™åˆ¶ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„é…ç½®ä½¿ç”¨å›½å†…çš„é•œåƒ(å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸ŠåŠ å¿«ä¸‹è½½çš„é€Ÿåº¦)ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;export PUB_HOSTED_URL=https://pub.flutter-io.cn
export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;1ã€ä¸‹è½½flutter&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ä¸‹è½½
git clone https://github.com/flutter/flutter.git

# åˆ‡æ¢åˆ°æœ€æ–°çš„tag(å½“å‰æœ€æ–°çš„æ˜¯v0.11.13)
git checkout v0.11.13
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ã€è®¾ç½®ç¯å¢ƒå˜é‡&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# è®¾ç½®ç¯å¢ƒå˜é‡
export PATH=`pwd`/flutter/bin:$PATH
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3ã€å®‰è£…ä¾èµ–&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# å®‰è£…ä¾èµ–
flutter doctor
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨å¯èƒ½æœ‰å¦‚ä¸‹æç¤ºï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[!] Android toolchain - develop for Android devices (Android SDK 28.0.1)
    âœ— Android licenses not accepted.  To resolve this, run: flutter doctor --android-licenses
[!] iOS toolchain - develop for iOS devices (Xcode 9.4.1)
    âœ— libimobiledevice and ideviceinstaller are not installed. To install, run:
        brew install --HEAD libimobiledevice
        brew install ideviceinstaller
    âœ— ios-deploy not installed. To install:
        brew install ios-deploy
[âœ“] Android Studio (version 3.1)
    âœ— Flutter plugin not installed; this adds Flutter specific functionality.
    âœ— Dart plugin not installed; this adds Dart specific functionality.
[!] IntelliJ IDEA Ultimate Edition (version 2017.3.3)
    âœ— Flutter plugin not installed; this adds Flutter specific functionality.
    âœ— Dart plugin not installed; this adds Dart specific functionality.
[!] Connected devices
    ! No devices available

! Doctor found issues in 4 categories.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æŒ‰ç…§ä¸Šé¢çš„è¯´æ˜è¿›è¡Œå¤„ç†å³å¯ï¼š&lt;/p&gt;

&lt;p&gt;(1) æ¥å—Androidå¼€å‘è€…åè®®&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;flutter doctor --android-licenses
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(2) å®‰è£…ä¸€äº›å¿…è¦çš„iOSçš„å·¥å…·&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;brew install --HEAD libimobiledevice
brew install ideviceinstaller
brew install ios-deploy
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ã€é…ç½®IDE&lt;/p&gt;

&lt;p&gt;(1) é…ç½®IDEA/Android Studio&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Preferences -&amp;gt; Plugins&lt;/code&gt;æœç´¢&lt;code class=&quot;highlighter-rouge&quot;&gt;Flutter&lt;/code&gt;å¹¶å®‰è£…æ’ä»¶&lt;/p&gt;

&lt;p&gt;ä¹Ÿå¯ä»¥åˆ°ä¸‹é¢çš„åœ°å€å»ä¸‹è½½&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://plugins.jetbrains.com/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(2) é…ç½®VS Code&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;View -&amp;gt; Command Palette&lt;/code&gt;è¾“å…¥&lt;code class=&quot;highlighter-rouge&quot;&gt;install&lt;/code&gt;, ç„¶åé€‰æ‹©&lt;code class=&quot;highlighter-rouge&quot;&gt;Extensions: Install Extension action&lt;/code&gt;, åœ¨æœç´¢æ¡†ä¸­è¾“å…¥&lt;code class=&quot;highlighter-rouge&quot;&gt;flutter&lt;/code&gt;åœ¨æœç´¢ç»“æœåˆ—è¡¨é‡Œé¢é€‰æ‹©&lt;code class=&quot;highlighter-rouge&quot;&gt;Flutter&lt;/code&gt;ç‚¹å‡»å®‰è£…(installï¼‰å³å¯ï¼Œå®‰è£…å®Œæˆåé€‰æ‹©OKé‡æ–°å¯åŠ¨VS Codeã€‚&lt;/p&gt;

&lt;p&gt;3ã€åˆå§‹åŒ–åˆ›å»ºé¡¹ç›®&lt;/p&gt;

&lt;p&gt;å‘½ä»¤è¡Œè¾“å…¥ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;flutter create hello_flutter&lt;/code&gt;ï¼Œå³å¯å¿«é€Ÿåˆ›å»ºä¸€ä¸ªFlutterçš„é¡¹ç›®, åˆ›å»ºå®Œæˆåå°±å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼å¿«é€Ÿè¿è¡Œï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# è¿›å…¥åˆ°å·¥ç¨‹ç›®å½•
cd hello_flutter
# æ‰“å¼€iPhoneæ¨¡æ‹Ÿå™¨
open -a Simulator
# è¿è¡Œ
flutter run
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;å¦‚ä½•ç¼–å†™flutteræ’ä»¶&quot;&gt;å¦‚ä½•ç¼–å†™Flutteræ’ä»¶&lt;/h3&gt;

&lt;p&gt;1ã€åˆ›å»ºæ¨¡æ¿å·¥ç¨‹&lt;/p&gt;

&lt;p&gt;å‘½ä»¤è¡Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;flutter create --template=plugin flutter_hybrid_router
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ã€å®ç°Dartè°ƒç”¨çš„ä»£ç &lt;/p&gt;

&lt;p&gt;åœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;lib/flutter_hybrid_router.dart&lt;/code&gt;ä¸­å®ç°Flutterç«¯è°ƒç”¨çš„æ–¹æ³•é€»è¾‘ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Future&amp;lt;void&amp;gt; openURL({String url, List parameters}) async {
    _channel.invokeMethod('openURL', {&quot;url&quot;: url ?? &quot;&quot;, &quot;parameters&quot;: (parameters ?? [])});
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3ã€å®ç°iOSç«¯çš„å®ç°é€»è¾‘&lt;/p&gt;

&lt;p&gt;å®ç°&lt;code class=&quot;highlighter-rouge&quot;&gt;handleMethodCall:result:&lt;/code&gt;æ–¹æ³•, Flutterç«¯dartä»£ç è°ƒç”¨Nativeçš„é€»è¾‘ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (void)handleMethodCall:(FlutterMethodCall *)call result:(FlutterResult)block {
    if ([@&quot;openURL&quot; isEqualToString:call.method]) {
        id arguments = call.arguments;
        if(arguments &amp;amp;&amp;amp; [arguments isKindOfClass:[NSDictionary class]]) {
            NSString *pattern = [arguments objectForKey:@&quot;url&quot;];
            NSArray *parameters = [arguments objectForKey:@&quot;parameters&quot;];
            if(!pattern || pattern.length &amp;lt;= 0) {
                !block ? : block(nil);
                return;
            }
            NSString *url = pattern;
            if(parameters &amp;amp;&amp;amp; [parameters isKindOfClass:[NSArray class]] &amp;amp;&amp;amp; parameters.count &amp;gt; 0) {
                url = [MGJRouter generateURLWithPattern:pattern parameters:parameters];
            }
            if(!url || url.length &amp;lt;= 0) {
                !block ? : block(nil);
                return;
            }
            [MGJRouter openURL:url completion:^(id result) {
                !block ? : block(result);
            }];
        }
        else {
            !block ? : block(nil);
        }
    }
    else {
        !block ? : block(FlutterMethodNotImplemented);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;é›†æˆåˆ°ç°æœ‰çš„é¡¹ç›®ä¸­&quot;&gt;é›†æˆåˆ°ç°æœ‰çš„é¡¹ç›®ä¸­&lt;/h3&gt;

&lt;p&gt;1ã€ä¿®æ”¹Podfile&lt;/p&gt;

&lt;p&gt;ä¿®æ”¹iosç›®å½•ä¸‹é¢çš„Podfileæ–‡ä»¶ï¼Œåœ¨é¡¶éƒ¨æ–°å¢ä¸¤è¡Œé…ç½®&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;platform :ios, '8.0'
use_frameworks!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ã€æ‰§è¡Œç¼–è¯‘è„šæœ¬&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo &quot;===æ¸…ç†flutterå†å²ç¼–è¯‘===&quot;
flutter clean

echo &quot;===é‡æ–°ç”Ÿæˆpluginç´¢å¼•===&quot;
flutter packages get

echo &quot;===ç”ŸæˆApp.frameworkå’Œflutter_assets===&quot;
flutter build ios --release

echo &quot;===ç”Ÿæˆå„ä¸ªpluginçš„äºŒè¿›åˆ¶åº“æ–‡ä»¶===&quot;
cd ios/Pods
for plugin_name in &quot;flutter_hybrid_router&quot; &quot;flutter_webview_plugin&quot;
do
    echo &quot;ç”Ÿæˆ${plugin_name}.framework...&quot;
    /usr/bin/env xcrun xcodebuild build -configuration Release ARCHS='arm64 armv7' -target ${plugin_name} BUILD_DIR=../../build/ios -sdk iphoneos -quiet
    /usr/bin/env xcrun xcodebuild build -configuration Debug ARCHS='x86_64' -target ${plugin_name} BUILD_DIR=../../build/ios -sdk iphonesimulator -quiet
    echo &quot;åˆå¹¶${plugin_name}.framework...&quot;
    lipo -create &quot;../../build/ios/Debug-iphonesimulator/${plugin_name}/${plugin_name}.framework/${plugin_name}&quot; &quot;../../build/ios/Release-iphoneos/${plugin_name}/${plugin_name}.framework/${plugin_name}&quot; -o &quot;../../build/ios/Release-iphoneos/${plugin_name}/${plugin_name}.framework/${plugin_name}&quot;
done
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è„šæœ¬æ‰§è¡Œå®Œæˆä¹‹åï¼Œåˆ›å»ºä¸€ä¸ªFlutterçš„æ–‡ä»¶å¤¹ï¼Œå°†ç”Ÿæˆçš„äº§ç‰©æ‹·è´è¿‡æ¥ï¼Œæ–‡ä»¶ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;.
â”œâ”€â”€ FlutterModule.podspec
â””â”€â”€ Pod
    â”œâ”€â”€ Assets
    â”‚Â Â  â””â”€â”€ flutter_assets
    â””â”€â”€ Framework
        â”œâ”€â”€ App.framework
        â”œâ”€â”€ Flutter.framework
        â”œâ”€â”€ flutter_hybrid_router.framework
        â””â”€â”€ flutter_webview_plugin.framework
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å…¶ä¸­&lt;code class=&quot;highlighter-rouge&quot;&gt;FlutterModule.podspec&lt;/code&gt;æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Pod::Spec.new do |s|
  s.name         = &quot;Flutter&quot;
  s.version      = &quot;0.1.0&quot;
  s.summary      = &quot;Flutter Demo&quot;
  s.description  = &amp;lt;&amp;lt;-DESC
    Flutter Demo                
  DESC
  s.homepage     = &quot;https://blog.devzeng.com&quot;
  s.license      = &quot;MIT&quot;
  s.platform = :ios, '8.0'
  s.author       = { &quot;zengjing&quot; =&amp;gt; &quot;hhtczengjing@gmail.com&quot; }
  s.source       = { :git =&amp;gt; &quot;&quot;, :tag =&amp;gt; &quot;#{s.version}&quot; }
  s.resources = &quot;Pod/Assets/*&quot;
  s.vendored_frameworks = &quot;Pod/Framework/**/*.framework&quot;
  s.dependency 'MGJRouter', '~&amp;gt; 0.10.0'
end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå°±å¯ä»¥ç›´æ¥åœ¨ä»£ç ä¸­å¼•ç”¨äº†ã€‚&lt;/p&gt;

&lt;p&gt;3ã€ä¸»å·¥ç¨‹ä¸­æ³¨å†Œæ’ä»¶&lt;/p&gt;

&lt;p&gt;(1) &lt;code class=&quot;highlighter-rouge&quot;&gt;AppDelegate&lt;/code&gt;ä¸­å®ç°&lt;code class=&quot;highlighter-rouge&quot;&gt;FlutterPluginRegistry&lt;/code&gt;åè®®&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    // æ³¨å†Œæ’ä»¶
    [FlutterHybridRouterPlugin registerWithRegistrar:[self registrarForPlugin:@&quot;FlutterHybridRouterPlugin&quot;]];
    
    // TODO: ç»™æ¯ä¸ªæ’ä»¶å‘é€æ¶ˆæ¯
 
    return YES;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(2) æ‰“å¼€Flutteré¡µé¢&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FlutterViewController *controller = [[FlutterViewController alloc] init];
[self.navigationController pushViewController:controller animated:YES];
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(3) å®ç°OpenURLçš„åè®®&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[MGJRouter registerURLPattern:@&quot;com.devzeng.demo://goback&quot; toHandler:^(NSDictionary *routerParameters) {
   UIViewController *controller = nil; // è·å–å½“å‰Flutteré¡µé¢
   [controller.navigationController popViewControllerAnimated:YES];
}];
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æœ€åï¼Œæœ¬æ–‡çš„demoå¯ä»¥åœ¨ä¸‹é¢æ‰¾åˆ°ï¼š&lt;/p&gt;

&lt;p&gt;(1) Flutteræ’ä»¶ç¤ºä¾‹ï¼š&lt;a href=&quot;https://github.com/hhtczengjing/flutter_hybrid_router_plugin.git&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;flutter_hybrid_router&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(2) Flutterç¤ºä¾‹é¡¹ç›®ï¼š&lt;a href=&quot;https://github.com/hhtczengjing/flutter_demo.git&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;flutter_demo&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(3) Flutterç¼–è¯‘åçš„æ¨¡å—ï¼š&lt;a href=&quot;https://github.com/hhtczengjing/flutter_module_example.git&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;flutter_module_example&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(4) Flutteré›†æˆåˆ°ç°æœ‰é¡¹ç›®ä¸­çš„ç¤ºä¾‹ï¼š&lt;a href=&quot;https://github.com/hhtczengjing/flutter_ios_project_integrate.git&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;flutter_ios_project_integrate&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;å‚è€ƒèµ„æ–™&lt;/h3&gt;

&lt;p&gt;1ã€&lt;a href=&quot;https://flutter.io/&quot;&gt;Flutterå®˜ç½‘&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2ã€&lt;a href=&quot;http://www.infoq.com/cn/articles/why-is-flutter-revolutionary&quot;&gt;ä¸ºä»€ä¹ˆè¯´Flutteræ˜¯é©å‘½æ€§çš„ï¼Ÿ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;3ã€&lt;a href=&quot;https://www.stephenw.cc/2018/04/20/dart-getting-start/&quot;&gt;è®¤è¯†Dartè¯­è¨€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4ã€&lt;a href=&quot;https://www.stephenw.cc/2018/04/21/dart-var-types/&quot;&gt;Dartçš„å˜é‡å’Œç±»å‹&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4ã€&lt;a href=&quot;https://www.stephenw.cc/2018/04/23/dart-func/&quot;&gt;Dartçš„å‡½æ•°&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;5ã€&lt;a href=&quot;https://www.stephenw.cc/2018/04/25/dart-class/&quot;&gt;Dartçš„ç±»&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;6ã€&lt;a href=&quot;https://www.stephenw.cc/2018/04/27/dart-generics/&quot;&gt;Dartä¸­çš„æ³›å‹&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Sun, 11 Nov 2018 18:46:37 +0800</pubDate>
        <link>http://blog.devzeng.com/blog/hello-flutter.html</link>
        <guid isPermaLink="true">http://blog.devzeng.com/blog/hello-flutter.html</guid>
        
        <category>iOS</category>
        
        
      </item>
    
      <item>
        <title>iOSä¸­ä½¿ç”¨cryptoppè¿›è¡ŒåŠ è§£å¯†</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://www.cryptopp.com&quot;&gt;Crypto++&lt;/a&gt;æ˜¯ä¸€ä¸ªå…è´¹å¼€æºçš„åŠ è§£å¯†åº“ï¼Œæ”¯æŒä¸€äº›éå¸¸ä¸°å¯Œçš„åŠ è§£å¯†ç®—æ³•(å¦‚AES/RSAç­‰)ã€‚å¦‚æœè¦è€ƒè™‘åˆ°å®ç°ä¸€å¥—è·¨å¹³å°å¤šç«¯åŠ è§£å¯†æ•ˆæœä¸€è‡´å¯ä»¥è€ƒè™‘ä½¿ç”¨è¯¥åº“ï¼Œå½“ç„¶ä½¿ç”¨å„è‡ªå¹³å°æä¾›çš„apiä¹Ÿèƒ½å®ç°ã€‚&lt;/p&gt;

&lt;p&gt;ç›®å‰åªæä¾›äº†æºç çš„æ–¹å¼ï¼Œå¦‚æœè¦é›†æˆåˆ°iOSçš„é¡¹ç›®é‡Œé¢éœ€è¦å…ˆç¼–è¯‘æˆé™æ€åº“ï¼Œä¸‹é¢å°±&lt;code class=&quot;highlighter-rouge&quot;&gt;5.6.2&lt;/code&gt;è¿™ä¸ªç‰ˆæœ¬è¿›è¡Œä»‹ç»ï¼š&lt;/p&gt;

&lt;h3 id=&quot;1ç¼–è¯‘é™æ€åº“&quot;&gt;1.ç¼–è¯‘é™æ€åº“&lt;/h3&gt;

&lt;h4 id=&quot;1-ä¸‹è½½æºç &quot;&gt;(1) ä¸‹è½½æºç &lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/weidai11/cryptopp.git
git checkout CRYPTOPP_5_6_2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;2-å‡†å¤‡ä¸€ä¸ªmakefileæ–‡ä»¶&quot;&gt;(2) å‡†å¤‡ä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;Makefile&lt;/code&gt;æ–‡ä»¶&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;touch Makefile
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ–‡ä»¶å†…å®¹ä¸ºï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CXXFLAGS += -g -O2 -Wall -Wno-unused -Wno-unknown-pragmas -DNDEBUG -DCRYPTOPP_DISABLE_ASM -DCRYPTOPP_DISABLE_SSE2 -MMD -MT dependencies

TARGET = libcryptopp.a
SRCS = $(shell echo *.cpp)
OBJS = $(SRCS:.cpp=.o)

.phoney: clean

all: $(TARGET)

$(TARGET): $(OBJS)
	$(AR) $(ARFLAGS) $@ $(OBJS)
	$(RANLIB) $@

%.o : %.cpp
	$(CXX) $(CXXFLAGS) -c $&amp;lt;

clean:
	$(RM) $(TARGET) $(OBJS)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;3-ç¼–å†™ç¼–è¯‘è„šæœ¬&quot;&gt;(3) ç¼–å†™ç¼–è¯‘è„šæœ¬&lt;/h4&gt;

&lt;h5 id=&quot;1-ioså¹³å°&quot;&gt;1) iOSå¹³å°&lt;/h5&gt;

&lt;p&gt;åˆ›å»ºè„šæœ¬æ–‡ä»¶ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;touch build-ios.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è„šæœ¬å†…å®¹ä¸ºï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;XCODE_ROOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;xcode-select &lt;span class=&quot;nt&quot;&gt;-print-path&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;making for iOS&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ARCHS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;x86_64 i386 armv7 armv7s arm64&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;SDK_VERSION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;xcrun &lt;span class=&quot;nt&quot;&gt;--sdk&lt;/span&gt; iphoneos &lt;span class=&quot;nt&quot;&gt;--show-sdk-version&lt;/span&gt; 2&amp;gt; /dev/null&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;MIN_SDK_VERSION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;7.0

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sdk version is: &quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SDK_VERSION&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;IOS_STATIC_ARCHIVES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;ARCH &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCHS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PLATFORM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;i386&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x86_64&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PLATFORM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhoneSimulator&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PLATFORM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;iPhoneOS&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;fi

    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DEV_ROOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;XCODE_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/Platforms/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PLATFORM&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.platform/Developer&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SDK_ROOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DEV_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/SDKs/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PLATFORM&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SDK_VERSION&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.sdk&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TOOLCHAIN_ROOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;XCODE_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/Toolchains/XcodeDefault.xctoolchain/usr/bin/&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;clang -arch &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ARCH&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -fembed-bitcode&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CXX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;clang++
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;AR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TOOLCHAIN_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;libtool
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;RANLIB&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TOOLCHAIN_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;ranlib
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARFLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-static -o&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LDFLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-arch &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -isysroot &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SDK_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;IOS_BUILD_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CXXFLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-x c++ -arch &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -isysroot &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SDK_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -I&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -miphoneos-version-min=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MIN_SDK_VERSION&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -mios-simulator-version-min=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MIN_SDK_VERSION&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-pv&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
    make &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; Makefile
    &lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.o &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.d &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;libcryptopp.a &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;IOS_STATIC_ARCHIVES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;IOS_STATIC_ARCHIVES&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/libcryptopp.a&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done

&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Creating universal library...&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; bin/ios
lipo &lt;span class=&quot;nt&quot;&gt;-create&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;IOS_STATIC_ARCHIVES&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-output&lt;/span&gt; bin/ios/libcryptopp.a

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;removing thin archs&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;ARCH &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCHS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;directoryName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;IOS_BUILD_&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;directoryName&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done

&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Build done!&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;2-macoså¹³å°&quot;&gt;2) macOSå¹³å°&lt;/h5&gt;

&lt;p&gt;åˆ›å»ºè„šæœ¬æ–‡ä»¶ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;touch build-macOS.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è„šæœ¬å†…å®¹ä¸ºï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;XCODE_ROOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;xcode-select &lt;span class=&quot;nt&quot;&gt;-print-path&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;making for macOSX&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ARCHS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;x86_64 i386&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;SDK_VERSION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;xcrun &lt;span class=&quot;nt&quot;&gt;--sdk&lt;/span&gt; macosx &lt;span class=&quot;nt&quot;&gt;--show-sdk-version&lt;/span&gt; 2&amp;gt; /dev/null&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;MIN_SDK_VERSION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10.10
&lt;span class=&quot;nv&quot;&gt;PLATFORM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;MacOSX&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sdk version is: &quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SDK_VERSION&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;MACOSX_STATIC_ARCHIVES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;ARCH &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCHS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DEV_ROOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;XCODE_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/Platforms/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PLATFORM&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.platform/Developer&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SDK_ROOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DEV_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/SDKs/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PLATFORM&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SDK_VERSION&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.sdk&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TOOLCHAIN_ROOT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;XCODE_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/Toolchains/XcodeDefault.xctoolchain/usr/bin/&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;clang -arch &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ARCH&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -fembed-bitcode&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CXX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;clang++
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;AR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TOOLCHAIN_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;libtool
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;RANLIB&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TOOLCHAIN_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;ranlib
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARFLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-static -o&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;LDFLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-arch &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -isysroot &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SDK_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;MACOSX_BUILD_&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CXXFLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-x c++ -arch &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -isysroot &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SDK_ROOT&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -I&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -mmacosx-version-min=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MIN_SDK_VERSION&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-pv&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
    make &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; Makefile
    &lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.o &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.d &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;libcryptopp.a &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nv&quot;&gt;MACOSX_STATIC_ARCHIVES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MACOSX_STATIC_ARCHIVES&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUILD_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/libcryptopp.a&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done

&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Creating universal library...&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; bin/macosx
lipo &lt;span class=&quot;nt&quot;&gt;-create&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MACOSX_STATIC_ARCHIVES&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-output&lt;/span&gt; bin/macosx/libcryptopp.a

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;removing thin archs&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;ARCH &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCHS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;directoryName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;MACOSX_BUILD_&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;directoryName&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done

&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Build done!&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2ä½¿ç”¨&quot;&gt;2.ä½¿ç”¨&lt;/h3&gt;

&lt;p&gt;ä¸‹é¢å°±MD5åŠ å¯†è¿›è¡Œç¤ºä¾‹å¦‚ä½•ä½¿ç”¨ï¼Œæ›´å¤šå…¶ä»–çš„ä½¿ç”¨æ–¹å¼è¯·å‚è€ƒå®˜æ–¹çš„æ–‡æ¡£ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// md5
// å¼•ç”¨å¤´æ–‡ä»¶`md5.h`
- (NSString *)getMD5String:(NSString *)str {
    NSData *data = [str dataUsingEncoding:NSUTF8StringEncoding];
    if(!data || data.length &amp;lt;= 0) {
        return nil;
    }
    CryptoPP::MD5 md5;
    byte digest[CryptoPP::MD5::DIGESTSIZE];
    md5.CalculateDigest(digest, (const byte*)[data bytes], [data length]);
    NSData *md5Dat = [NSData dataWithBytes:digest length:sizeof digest];
    NSMutableString *s = [NSMutableString string];
    unsigned char *hashValue = (byte *)[md5Dat bytes];
    int i;
    for (i = 0; i &amp;lt; [md5Dat length]; i++) {
        [s appendFormat:@&quot;%02x&quot;, hashValue[i]];
    }
    return s;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;å‚è€ƒèµ„æ–™&lt;/h3&gt;

&lt;p&gt;1ã€&lt;a href=&quot;https://www.cnblogs.com/cocoajin/p/6112562.html&quot;&gt;Cryptopp iOS ä½¿ç”¨ RSAåŠ å¯†è§£å¯†å’Œç­¾åéªŒè¯ç­¾å&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2ã€&lt;a href=&quot;https://www.cryptopp.com/docs/ref/&quot;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 04 Oct 2018 18:46:37 +0800</pubDate>
        <link>http://blog.devzeng.com/blog/ios-cryptopp-encryption.html</link>
        <guid isPermaLink="true">http://blog.devzeng.com/blog/ios-cryptopp-encryption.html</guid>
        
        <category>iOS</category>
        
        
      </item>
    
      <item>
        <title>iOSä¸­Masonryæºç åˆ†æ</title>
        <description>&lt;p&gt;Masonryæ˜¯ä¸€ä¸ªè½»é‡çº§çš„iOSå¸ƒå±€æ¡†æ¶ï¼Œä½¿ç”¨ä¸€å¥—æ›´åŠ æ–¹ä¾¿çš„è¯­æ³•æ¥å¯¹AutoLayoutè¿›è¡ŒåŒ…è£…ã€‚å®ƒæ‹¥æœ‰è‡ªå·±çš„æè¿°è¯­æ³•(DSL)ï¼Œ é‡‡ç”¨æ›´ä¼˜é›…çš„é“¾å¼è¯­æ³•å°è£…äº†AutoLayoutï¼Œç®€ä»‹æ˜äº†å¹¶å…·å¤‡é«˜å¯è¯»æ€§ã€‚åŒæ—¶æ”¯æŒiOSå’ŒmacOSã€‚&lt;/p&gt;

&lt;h3 id=&quot;autolayout&quot;&gt;AutoLayout&lt;/h3&gt;

&lt;p&gt;éœ€æ±‚ï¼šåœ¨çˆ¶è§†å›¾ä¸Šé¢åˆ›å»ºä¸€ä¸ªç»¿è‰²çš„è§†å›¾ï¼Œè¦æ±‚è·çˆ¶è§†å›¾çš„è¾¹è·éƒ½æ˜¯10ï¼Œä½¿ç”¨ä»£ç æ–¹å¼å®ç°æ–¹å¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;h4 id=&quot;1-åˆ›å»ºè§†å›¾æ§ä»¶&quot;&gt;(1) åˆ›å»ºè§†å›¾æ§ä»¶&lt;/h4&gt;

&lt;p&gt;åˆ›å»ºä¸€ä¸ªUIViewè§†å›¾ï¼Œå¹¶æŠŠå®ƒæ·»åŠ åˆ°çˆ¶è§†å›¾ä¸Šé¢ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;UIView *view1 = [[UIView alloc] init];
view1.backgroundColor = [UIColor greenColor];
[self.view addSubview:view1];
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;2-è®¾ç½®å…³é—­autoresizing&quot;&gt;(2) è®¾ç½®å…³é—­Autoresizing&lt;/h4&gt;

&lt;p&gt;å› ä¸ºAutoLayoutå’ŒAutoresizingä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼Œåœ¨ä½¿ç”¨AutoLayoutä¹‹å‰å¿…é¡»å…ˆè®¾ç½®å…³é—­
Autoresizingï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;view1.translatesAutoresizingMaskIntoConstraints = NO;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;3-åˆ›å»ºå¹¶æ·»åŠ çº¦æŸ&quot;&gt;(3) åˆ›å»ºå¹¶æ·»åŠ çº¦æŸ&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;NSLayoutConstraint *topC = [NSLayoutConstraint constraintWithItem:view1
                                 attribute:NSLayoutAttributeTop
                                 relatedBy:NSLayoutRelationEqual
                                    toItem:self.view
                                 attribute:NSLayoutAttributeTop
                                multiplier:1.0
                                  constant:10];
                                  
NSLayoutConstraint *leftC = [NSLayoutConstraint constraintWithItem:view1
                                 attribute:NSLayoutAttributeLeft
                                 relatedBy:NSLayoutRelationEqual
                                    toItem:self.view
                                 attribute:NSLayoutAttributeLeft
                                multiplier:1.0
                                  constant:10];

NSLayoutConstraint *bottomC = [NSLayoutConstraint constraintWithItem:view1
                                 attribute:NSLayoutAttributeBottom
                                 relatedBy:NSLayoutRelationEqual
                                    toItem:self.view
                                 attribute:NSLayoutAttributeBottom
                                multiplier:1.0
                                  constant:-10];

NSLayoutConstraint *rightC = [NSLayoutConstraint constraintWithItem:view1
                                 attribute:NSLayoutAttributeRight
                                 relatedBy:NSLayoutRelationEqual
                                    toItem:self.view
                                 attribute:NSLayoutAttributeRight
                                multiplier:1.0
                                  constant:-10];
                                  
[self.view addConstraints:@[topC, leftC, bottomC, rightC]];
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä½¿ç”¨Masonryå®ç°æ–¹å¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;UIEdgeInsets padding = UIEdgeInsetsMake(10, 10, 10, 10);

[view1 mas_makeConstraints:^(MASConstraintMaker *make) {
    make.top.equalTo(self.view.mas_top).with.offset(padding.top);
    make.left.equalTo(self.view.mas_left).with.offset(padding.left);
    make.bottom.equalTo(self.view.mas_bottom).with.offset(-padding.bottom);
    make.right.equalTo(self.view.mas_right).with.offset(-padding.right);
}];

æˆ–è€…æ˜¯ï¼š

[view1 mas_makeConstraints:^(MASConstraintMaker *make) {
    make.edges.equalTo(self.view).with.insets(padding);
}];
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;æºç åˆ†æ&quot;&gt;æºç åˆ†æ&lt;/h3&gt;

&lt;p&gt;ç›¸æ¯”ä½¿ç”¨åŸç”Ÿçš„AutoLayoutä½¿ç”¨Masonryä»£ç æ›´åŠ çš„ç®€æ´ï¼Œæ¥ä¸‹æ¥ä»æºç çš„æ–¹å¼æ¥çœ‹ä¸‹Masonryæ˜¯å¦‚ä½•å¤„ç†çš„ï¼Œé¦–å…ˆMasonryæä¾›äº†ä¸€ä¸ªCategory(&lt;code class=&quot;highlighter-rouge&quot;&gt;UIView+MASAdditions&lt;/code&gt;)ï¼Œ è¯¥Categoryå®ç°äº†å¦‚ä¸‹å‡ ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨äºçº¦æŸçš„åˆ›å»ºã€æ›´æ–°å’Œé‡ç½®ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// åˆ›å»ºçº¦æŸ
- (NSArray *)mas_makeConstraints:(void(NS_NOESCAPE ^)(MASConstraintMaker *make))block;

// æ›´æ–°çº¦æŸ
- (NSArray *)mas_updateConstraints:(void(NS_NOESCAPE ^)(MASConstraintMaker *make))block;

// é‡ç½®çº¦æŸ
- (NSArray *)mas_remakeConstraints:(void(NS_NOESCAPE ^)(MASConstraintMaker *make))block;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä»¥åˆ›å»ºçº¦æŸä¸ºä¾‹ï¼Œé‡Œé¢çš„å…·ä½“å®ç°ä»£ç ä¸ºï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (NSArray *)mas_makeConstraints:(void(^)(MASConstraintMaker *))block {
	 // å…³é—­Autoresizing
    self.translatesAutoresizingMaskIntoConstraints = NO;
    MASConstraintMaker *constraintMaker = [[MASConstraintMaker alloc] initWithView:self];
    block(constraintMaker);
    return [constraintMaker install];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºæ¥ï¼Œåˆ›å»ºçº¦æŸçš„æ—¶å€™é¦–å…ˆä¼šå…³é—­Autoresizingï¼Œç„¶åä¼šåˆ›å»ºä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;MASConstraintMaker&lt;/code&gt;å¯¹è±¡ï¼Œç„¶åæš´éœ²ç»™å¼€å‘è€…ä¸€ä¸ªblockï¼Œåœ¨blocké‡Œé¢å®ç°å…·ä½“çš„çº¦æŸï¼Œæœ€åè°ƒç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;install&lt;/code&gt;å®‰è£…çº¦æŸã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// MASConstraintMaker
- (id)initWithView:(MAS_VIEW *)view {
    self = [super init];
    if (!self) return nil;
    
    self.view = view;
    self.constraints = NSMutableArray.new;
    
    return self;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;make.left.equalTo(self.view.mas_left).with.offset(10);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(1) &lt;code class=&quot;highlighter-rouge&quot;&gt;make.left&lt;/code&gt;ç­‰ä»·äºï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// MASConstraintMaker
- (MASConstraint *)left {
    return [self addConstraintWithLayoutAttribute:NSLayoutAttributeLeft];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (MASConstraint *)addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute {
    return [self constraint:nil addConstraintWithLayoutAttribute:layoutAttribute];
}

//ç”±äºconstraintä¸ºnilï¼Œåˆ é™¤ä¸€äº›æ— æ•ˆçš„ä»£ç 
- (MASConstraint *)constraint:(MASConstraint *)constraint addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute {
    MASViewAttribute *viewAttribute = [[MASViewAttribute alloc] initWithView:self.view layoutAttribute:layoutAttribute];
    MASViewConstraint *newConstraint = [[MASViewConstraint alloc] initWithFirstViewAttribute:viewAttribute];
    if (!constraint) {
        newConstraint.delegate = self;
        [self.constraints addObject:newConstraint];
    }
    return newConstraint;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(2) &lt;code class=&quot;highlighter-rouge&quot;&gt;self.view.mas_left&lt;/code&gt;ç­‰ä»·äºï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// UIView+MASAdditions
- (MASViewAttribute *)mas_left {
    return [[MASViewAttribute alloc] initWithView:self layoutAttribute:NSLayoutAttributeLeft];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(3) &lt;code class=&quot;highlighter-rouge&quot;&gt;equalTo&lt;/code&gt;ç­‰ä»·äºï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (MASConstraint * (^)(id))equalTo {
    return ^id(id attribute) {
        return self.equalToWithRelation(attribute, NSLayoutRelationEqual);
    };
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;equalToWithRelation&lt;/code&gt;æ–¹æ³•æ˜¯åœ¨å­ç±»ä¸­å®ç°çš„ï¼Œçˆ¶ç±»ä¸­ä¸æä¾›å®ç°ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#define MASMethodNotImplemented() \
    @throw [NSException exceptionWithName:NSInternalInconsistencyException \
                                   reason:[NSString stringWithFormat:@&quot;You must override %@ in a subclass.&quot;, NSStringFromSelector(_cmd)] \
                                 userInfo:nil]

- (MASConstraint * (^)(id, NSLayoutRelation))equalToWithRelation { 
    MASMethodNotImplemented(); 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥åˆ°&lt;code class=&quot;highlighter-rouge&quot;&gt;MASViewConstraint&lt;/code&gt;ä¸­æ‰¾åˆ°å…·ä½“çš„å®ç°ä»£ç ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (MASConstraint * (^)(id, NSLayoutRelation))equalToWithRelation {
    return ^id(id attribute, NSLayoutRelation relation) {
        if ([attribute isKindOfClass:NSArray.class]) {
            NSAssert(!self.hasLayoutRelation, @&quot;Redefinition of constraint relation&quot;);
            NSMutableArray *children = NSMutableArray.new;
            for (id attr in attribute) {
                MASViewConstraint *viewConstraint = [self copy];
                viewConstraint.layoutRelation = relation;
                viewConstraint.secondViewAttribute = attr;
                [children addObject:viewConstraint];
            }
            MASCompositeConstraint *compositeConstraint = [[MASCompositeConstraint alloc] initWithChildren:children];
            compositeConstraint.delegate = self.delegate;
            [self.delegate constraint:self shouldBeReplacedWithConstraint:compositeConstraint];
            return compositeConstraint;
        } 
        else {
            NSAssert(!self.hasLayoutRelation || self.layoutRelation == relation &amp;amp;&amp;amp; [attribute isKindOfClass:NSValue.class], @&quot;Redefinition of constraint relation&quot;);
            self.layoutRelation = relation;
            self.secondViewAttribute = attribute;
            return self;
        }
    };
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é‡å†™äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;secondViewAttributeçš„setter&lt;/code&gt;æ–¹æ³•ï¼Œæ ¹æ®ä¸åŒçš„ç±»å‹è¿›è¡Œå¤„ç†&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (void)setSecondViewAttribute:(id)secondViewAttribute {
    if ([secondViewAttribute isKindOfClass:NSValue.class]) {
        [self setLayoutConstantWithValue:secondViewAttribute];
    } 
    else if ([secondViewAttribute isKindOfClass:MAS_VIEW.class]) {
        _secondViewAttribute = [[MASViewAttribute alloc] initWithView:secondViewAttribute layoutAttribute:self.firstViewAttribute.layoutAttribute];
    } 
    else if ([secondViewAttribute isKindOfClass:MASViewAttribute.class]) {
        _secondViewAttribute = secondViewAttribute;
    } 
    else {
        NSAssert(NO, @&quot;attempting to add unsupported attribute: %@&quot;, secondViewAttribute);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;1) é’ˆå¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;NSValue&lt;/code&gt;ç±»å‹çš„æ•°æ®&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (void)setLayoutConstantWithValue:(NSValue *)value {
    if ([value isKindOfClass:NSNumber.class]) {
        self.offset = [(NSNumber *)value doubleValue];
    } 
    else if (strcmp(value.objCType, @encode(CGPoint)) == 0) {
        CGPoint point;
        [value getValue:&amp;amp;point];
        self.centerOffset = point;
    }
    else if (strcmp(value.objCType, @encode(CGSize)) == 0) {
        CGSize size;
        [value getValue:&amp;amp;size];
        self.sizeOffset = size;
    } 
    else if (strcmp(value.objCType, @encode(MASEdgeInsets)) == 0) {
        MASEdgeInsets insets;
        [value getValue:&amp;amp;insets];
        self.insets = insets;
    }
    else {
        NSAssert(NO, @&quot;attempting to set layout constant with unsupported value: %@&quot;, value);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2) é’ˆå¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;UIView/NSView&lt;/code&gt;ç±»å‹çš„æ•°æ®ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_secondViewAttribute = [[MASViewAttribute alloc] initWithView:secondViewAttribute layoutAttribute:self.firstViewAttribute.layoutAttribute];
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3) é’ˆå¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;MASViewAttribute&lt;/code&gt;ç±»å‹çš„æ•°æ®&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_secondViewAttribute = secondViewAttribute;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(4) &lt;code class=&quot;highlighter-rouge&quot;&gt;with&lt;/code&gt;ç­‰ä»·äº&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (MASConstraint *)with {
    return self;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å…¶å®å°±æ˜¯è¿”å›ä¸€ä¸ªå½“å‰å¯¹è±¡ï¼Œæ²¡æœ‰å®é™…çš„æ„ä¹‰ï¼Œæ–¹ä¾¿é˜…è¯»&lt;/p&gt;

&lt;p&gt;æœ€ååˆ›å»ºå®Œçº¦æŸä¹‹åä¼šè°ƒç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;install&lt;/code&gt;æ–¹æ³•ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// MASConstraintMaker
- (NSArray *)install {
    if (self.removeExisting) {
        NSArray *installedConstraints = [MASViewConstraint installedConstraintsForView:self.view];
        for (MASConstraint *constraint in installedConstraints) {
            [constraint uninstall];
        }
    }
    NSArray *constraints = self.constraints.copy;
    for (MASConstraint *constraint in constraints) {
        constraint.updateExisting = self.updateExisting;
        [constraint install];
    }
    [self.constraints removeAllObjects];
    return constraints;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åœ¨è¿™ä¸ªæ–¹æ³•ä¼šå…ˆåˆ¤æ–­å½“å‰çš„è§†å›¾çš„çº¦æŸæ˜¯å¦åº”è¯¥è¦è¢«&lt;code class=&quot;highlighter-rouge&quot;&gt;uninstall&lt;/code&gt;, å¦‚æœæˆ‘ä»¬åœ¨æœ€å¼€å§‹è°ƒç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;mas_remakeConstraints:&lt;/code&gt;æ–¹æ³•æ—¶, è§†å›¾ä¸­åŸæ¥çš„çº¦æŸå°±ä¼šå…¨éƒ¨è¢«&lt;code class=&quot;highlighter-rouge&quot;&gt;uninstall&lt;/code&gt;ã€‚ç„¶åå°±ä¼šéå†&lt;code class=&quot;highlighter-rouge&quot;&gt;constraints&lt;/code&gt;æ•°ç»„, å‘é€&lt;code class=&quot;highlighter-rouge&quot;&gt;install&lt;/code&gt;æ¶ˆæ¯ã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// MASConstraint
- (void)install {
    if (self.hasBeenInstalled) {
        return;
    }
    
    // æ˜¯å¦æ¿€æ´»è¯¥çº¦æŸ
    if ([self supportsActiveProperty] &amp;amp;&amp;amp; self.layoutConstraint) {
        self.layoutConstraint.active = YES;
        [self.firstViewAttribute.view.mas_installedConstraints addObject:self];
        return;
    }
    

    MAS_VIEW *firstLayoutItem = self.firstViewAttribute.item;
    NSLayoutAttribute firstLayoutAttribute = self.firstViewAttribute.layoutAttribute;
    
    MAS_VIEW *secondLayoutItem = self.secondViewAttribute.item;
    NSLayoutAttribute secondLayoutAttribute = self.secondViewAttribute.layoutAttribute;
    
    // alignment attributes must have a secondViewAttribute therefore we assume that is refering to superview
    // eg make.left.equalTo(@10)
    // å¯¹äºä¸æ˜¯å€¼ç±»å‹çš„æ•°æ®ï¼Œéœ€è¦è®¾ç½®ç¬¬äºŒä¸ªè§†å›¾
    if (!self.firstViewAttribute.isSizeAttribute &amp;amp;&amp;amp; !self.secondViewAttribute) {
        secondLayoutItem = self.firstViewAttribute.view.superview;
        secondLayoutAttribute = firstLayoutAttribute;
    }
    
    // MASLayoutConstraint ç»§æ‰¿è‡ª NSLayoutConstraint
    // çº¦æŸå…¬å¼ firstView.attribute = secondView.attribute * layoutMultiplier + layoutConstant
    MASLayoutConstraint *layoutConstraint = [MASLayoutConstraint constraintWithItem:firstLayoutItem 
                                                                          attribute:firstLayoutAttribute
                                                                          relatedBy:self.layoutRelation
                                                                             toItem:secondLayoutItem
                                                                          attribute:secondLayoutAttribute
                                                                         multiplier:self.layoutMultiplier
                                                                           constant:self.layoutConstant];
    // ä¼˜å…ˆçº§
    layoutConstraint.priority = self.layoutPriority;
    // æ ‡è¯†ç¬¦, è°ƒè¯•çš„æ—¶å€™ä½¿ç”¨
    layoutConstraint.mas_key = self.mas_key;
    
    if (self.secondViewAttribute.view) {
        // ä¸¤ä¸ªè§†å›¾è¿›è¡Œçº¦æŸï¼Œå¯»æ‰¾ä¸¤ä¸ªè§†å›¾çš„å…±åŒçˆ¶è§†å›¾ï¼Œåœ¨å…±åŒçš„çˆ¶è§†å›¾ä¸Šé¢æ·»åŠ çº¦æŸ
        MAS_VIEW *closestCommonSuperview = [self.firstViewAttribute.view mas_closestCommonSuperview:self.secondViewAttribute.view];
        NSAssert(closestCommonSuperview, @&quot;couldn't find a common superview for %@ and %@&quot;, self.firstViewAttribute.view, self.secondViewAttribute.view);
        self.installedView = closestCommonSuperview;
    } 
    else if (self.firstViewAttribute.isSizeAttribute) {
        // å¯¹äºæ•°å€¼ç±»å‹çš„å±æ€§ï¼Œç›´æ¥åœ¨å½“å‰è§†å›¾ä¸Šé¢æ·»åŠ çº¦æŸ
        self.installedView = self.firstViewAttribute.view;
    } 
    else {
        // åœ¨çˆ¶è§†å›¾ä¸Šé¢æ·»åŠ çº¦æŸ
        self.installedView = self.firstViewAttribute.view.superview;
    }
    
    MASLayoutConstraint *existingConstraint = nil;
    if (self.updateExisting) {
        // å¦‚æœéœ€è¦æ›´æ–°çº¦æŸï¼ŒæŸ¥æ‰¾å¯¹åº”çš„çº¦æŸ
        existingConstraint = [self layoutConstraintSimilarTo:layoutConstraint];
    }
    if (existingConstraint) {
        // æ›´æ–°çº¦æŸçš„constant
        existingConstraint.constant = layoutConstraint.constant;
        self.layoutConstraint = existingConstraint;
    } 
    else {
        // æ·»åŠ ä¸€ä¸ªæ–°çš„çº¦æŸ
        [self.installedView addConstraint:layoutConstraint];
        self.layoutConstraint = layoutConstraint;
        [firstLayoutItem.mas_installedConstraints addObject:self];
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è·å–ä¸¤ä¸ªè§†å›¾å…±åŒçš„çˆ¶è§†å›¾ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// UIView+MASAdditions
- (instancetype)mas_closestCommonSuperview:(MAS_VIEW *)view {
    MAS_VIEW *closestCommonSuperview = nil;

    MAS_VIEW *secondViewSuperview = view;
    while (!closestCommonSuperview &amp;amp;&amp;amp; secondViewSuperview) {
        MAS_VIEW *firstViewSuperview = self;
        while (!closestCommonSuperview &amp;amp;&amp;amp; firstViewSuperview) {
            if (secondViewSuperview == firstViewSuperview) {
                closestCommonSuperview = secondViewSuperview;
            }
            firstViewSuperview = firstViewSuperview.superview;
        }
        secondViewSuperview = secondViewSuperview.superview;
    }
    return closestCommonSuperview;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æˆ–è€…åŒæŒ‡å®šçº¦æŸç›¸ä¼¼çš„çº¦æŸï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (MASLayoutConstraint *)layoutConstraintSimilarTo:(MASLayoutConstraint *)layoutConstraint {
    // åˆ¤æ–­ä¸¤ä¸ªçº¦æŸæ˜¯å¦ç›¸ä¼¼ï¼Œéœ€è¦ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œè€ƒé‡
    for (NSLayoutConstraint *existingConstraint in self.installedView.constraints.reverseObjectEnumerator) {
        if (![existingConstraint isKindOfClass:MASLayoutConstraint.class]) continue;
        if (existingConstraint.firstItem != layoutConstraint.firstItem) continue;
        if (existingConstraint.secondItem != layoutConstraint.secondItem) continue;
        if (existingConstraint.firstAttribute != layoutConstraint.firstAttribute) continue;
        if (existingConstraint.secondAttribute != layoutConstraint.secondAttribute) continue;
        if (existingConstraint.relation != layoutConstraint.relation) continue;
        if (existingConstraint.multiplier != layoutConstraint.multiplier) continue;
        if (existingConstraint.priority != layoutConstraint.priority) continue;
        return (id)existingConstraint;
    }
    return nil;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå·²ç»å·®ä¸å¤šäº†ï¼Œé’ˆå¯¹&lt;code class=&quot;highlighter-rouge&quot;&gt;edges&lt;/code&gt;è¿™ç§ç±»å‹çš„æºç å®ç°å¦‚ä¸‹ï¼Œå…¶å®å°±æ˜¯ä½¿ç”¨çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;MASCompositeConstraint&lt;/code&gt;æ‰¹é‡åˆ›å»ºä¸€ç³»åˆ—çº¦æŸï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (MASConstraint *)edges {
    return [self addConstraintWithAttributes:MASAttributeTop | MASAttributeLeft | MASAttributeRight | MASAttributeBottom];
}

- (MASConstraint *)addConstraintWithAttributes:(MASAttribute)attrs {
    __unused MASAttribute anyAttribute = (MASAttributeLeft | MASAttributeRight | MASAttributeTop | MASAttributeBottom | MASAttributeLeading
                                          | MASAttributeTrailing | MASAttributeWidth | MASAttributeHeight | MASAttributeCenterX
                                          | MASAttributeCenterY | MASAttributeBaseline
#if (__IPHONE_OS_VERSION_MIN_REQUIRED &amp;gt;= 80000) || (__TV_OS_VERSION_MIN_REQUIRED &amp;gt;= 9000) || (__MAC_OS_X_VERSION_MIN_REQUIRED &amp;gt;= 101100)
                                          | MASAttributeFirstBaseline | MASAttributeLastBaseline
#endif
#if (__IPHONE_OS_VERSION_MIN_REQUIRED &amp;gt;= 80000) || (__TV_OS_VERSION_MIN_REQUIRED &amp;gt;= 9000)
                                          | MASAttributeLeftMargin | MASAttributeRightMargin | MASAttributeTopMargin | MASAttributeBottomMargin
                                          | MASAttributeLeadingMargin | MASAttributeTrailingMargin | MASAttributeCenterXWithinMargins
                                          | MASAttributeCenterYWithinMargins
#endif
                                          );
    
    NSAssert((attrs &amp;amp; anyAttribute) != 0, @&quot;You didn't pass any attribute to make.attributes(...)&quot;);
    
    NSMutableArray *attributes = [NSMutableArray array];
    
    if (attrs &amp;amp; MASAttributeLeft) [attributes addObject:self.view.mas_left];
    if (attrs &amp;amp; MASAttributeRight) [attributes addObject:self.view.mas_right];
    if (attrs &amp;amp; MASAttributeTop) [attributes addObject:self.view.mas_top];
    if (attrs &amp;amp; MASAttributeBottom) [attributes addObject:self.view.mas_bottom];
    if (attrs &amp;amp; MASAttributeLeading) [attributes addObject:self.view.mas_leading];
    if (attrs &amp;amp; MASAttributeTrailing) [attributes addObject:self.view.mas_trailing];
    if (attrs &amp;amp; MASAttributeWidth) [attributes addObject:self.view.mas_width];
    if (attrs &amp;amp; MASAttributeHeight) [attributes addObject:self.view.mas_height];
    if (attrs &amp;amp; MASAttributeCenterX) [attributes addObject:self.view.mas_centerX];
    if (attrs &amp;amp; MASAttributeCenterY) [attributes addObject:self.view.mas_centerY];
    if (attrs &amp;amp; MASAttributeBaseline) [attributes addObject:self.view.mas_baseline];
    
#if (__IPHONE_OS_VERSION_MIN_REQUIRED &amp;gt;= 80000) || (__TV_OS_VERSION_MIN_REQUIRED &amp;gt;= 9000) || (__MAC_OS_X_VERSION_MIN_REQUIRED &amp;gt;= 101100)
    if (attrs &amp;amp; MASAttributeFirstBaseline) [attributes addObject:self.view.mas_firstBaseline];
    if (attrs &amp;amp; MASAttributeLastBaseline) [attributes addObject:self.view.mas_lastBaseline];
#endif
    
#if (__IPHONE_OS_VERSION_MIN_REQUIRED &amp;gt;= 80000) || (__TV_OS_VERSION_MIN_REQUIRED &amp;gt;= 9000)
    
    if (attrs &amp;amp; MASAttributeLeftMargin) [attributes addObject:self.view.mas_leftMargin];
    if (attrs &amp;amp; MASAttributeRightMargin) [attributes addObject:self.view.mas_rightMargin];
    if (attrs &amp;amp; MASAttributeTopMargin) [attributes addObject:self.view.mas_topMargin];
    if (attrs &amp;amp; MASAttributeBottomMargin) [attributes addObject:self.view.mas_bottomMargin];
    if (attrs &amp;amp; MASAttributeLeadingMargin) [attributes addObject:self.view.mas_leadingMargin];
    if (attrs &amp;amp; MASAttributeTrailingMargin) [attributes addObject:self.view.mas_trailingMargin];
    if (attrs &amp;amp; MASAttributeCenterXWithinMargins) [attributes addObject:self.view.mas_centerXWithinMargins];
    if (attrs &amp;amp; MASAttributeCenterYWithinMargins) [attributes addObject:self.view.mas_centerYWithinMargins];
    
#endif
    
    NSMutableArray *children = [NSMutableArray arrayWithCapacity:attributes.count];
    
    for (MASViewAttribute *a in attributes) {
        [children addObject:[[MASViewConstraint alloc] initWithFirstViewAttribute:a]];
    }
    
    MASCompositeConstraint *constraint = [[MASCompositeConstraint alloc] initWithChildren:children];
    constraint.delegate = self;
    [self.constraints addObject:constraint];
    return constraint;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;å‚è€ƒèµ„æ–™&lt;/h3&gt;

&lt;p&gt;1ã€&lt;a href=&quot;https://github.com/SnapKit/Masonry&quot;&gt;Masonryé¡¹ç›®ä¸»é¡µ&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Sat, 01 Sep 2018 13:22:56 +0800</pubDate>
        <link>http://blog.devzeng.com/blog/ios-masonry-source.html</link>
        <guid isPermaLink="true">http://blog.devzeng.com/blog/ios-masonry-source.html</guid>
        
        <category>iOS</category>
        
        
      </item>
    
      <item>
        <title>iOSä¸­WebViewJavaScriptBridgeæºç åˆ†æ</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://github.com/marcuswestin/WebViewJavascriptBridge&quot;&gt;WebViewJavascriptBridge&lt;/a&gt;æ˜¯ä¸€ä¸ªWebViewä¸­JavaScriptå’ŒNativeè¿›è¡Œäº¤äº’çš„æ¡†æ¶ï¼Œä½¿ç”¨è¿™ä¸ªæ¡†æ¶èƒ½å¤Ÿå®ç°JavaScriptå’ŒObjective-Cä¹‹é—´è¿›è¡Œæ¶ˆæ¯çš„äº’é€šã€‚å¦å¤–è¿™ä¸ªæ¡†æ¶è®¾è®¡çš„ä¹Ÿæ˜¯éå¸¸çš„ç®€ä»‹ï¼Œåªæœ‰å¦‚ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼š&lt;/p&gt;

&lt;p&gt;(1) &lt;code class=&quot;highlighter-rouge&quot;&gt;WebViewJavascriptBridge_JS&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;è¯¥æ–‡ä»¶ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•&lt;code class=&quot;highlighter-rouge&quot;&gt;NSString * WebViewJavascriptBridge_js(void);&lt;/code&gt;, è¯¥æ–¹æ³•ä¸»è¦æ˜¯æä¾›æ‹¼æ¥åˆ›å»ºä¸€ä¸ªJavaScriptçš„è„šæ­¥ä»£ç ï¼Œåœ¨æ—§ç‰ˆä¸­è¯¥æ–‡ä»¶ç”Ÿæˆçš„JSä»£ç æ˜¯ç”¨ä¸€ä¸ªtxtæ–‡ä»¶è¿›è¡Œä¿å­˜çš„ã€‚ç”Ÿæˆçš„JSä»£ç ä¸»è¦è´Ÿè´£å¯¹Nativeç«¯å‘é€çš„æ¶ˆæ¯è¿›è¡Œå¤„ç†ä¸å°†JavaScriptç«¯çš„æ¶ˆæ¯å‘é€åˆ°Nativeç«¯ï¼Œå¦å¤–è¿›è¡Œä¸€äº›å…¨å±€çš„ç»„ä»¶çš„æ³¨å†Œç­‰ã€‚&lt;/p&gt;

&lt;p&gt;(2) &lt;code class=&quot;highlighter-rouge&quot;&gt;WebViewJavascriptBridgeBase&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å®ç°äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;Bridge&lt;/code&gt;çš„åˆå§‹åŒ–ï¼Œæä¾›WebViewã€Nativeä¹‹é—´çš„æ¶ˆæ¯é€šé“&lt;/p&gt;

&lt;p&gt;(3) &lt;code class=&quot;highlighter-rouge&quot;&gt;WKWebViewJavascriptBridge/WebViewJavascriptBridge&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;åˆ†åˆ«è´Ÿè´£WKWebViewå’ŒUIWebViewåŒNativeä¹‹é—´çš„æ¶ˆæ¯å¤„ç†ï¼Œå®ç°äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;Handler&lt;/code&gt;çš„æ³¨å†Œå’Œè°ƒç”¨é€»è¾‘ï¼Œé€šè¿‡å¯¹å„è‡ªå¹³å°ä¸‹é¢çš„ä¸€äº›å…³é”®å›è°ƒæ–¹æ³•è¿›è¡Œå¤„ç†å®ç°å¯¹JavaScriptç«¯å‘é€çš„æ¶ˆæ¯è¿›è¡Œæ‹¦æˆªå¹¶è¿›è¡Œè§£æå¤„ç†ç­‰æµç¨‹ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å¦‚ä½•ä½¿ç”¨&quot;&gt;å¦‚ä½•ä½¿ç”¨&lt;/h3&gt;

&lt;h4 id=&quot;1javascriptç«¯&quot;&gt;1ã€JavaScriptç«¯&lt;/h4&gt;

&lt;p&gt;Bridgeçš„åˆ›å»ºï¼Œè°ƒç”¨æœ¬å‡½æ•°ä¼šè§¦å‘Nativeç«¯æ‰§è¡Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;WebViewJavascriptBridge_JS&lt;/code&gt;æ–‡ä»¶é‡Œé¢çš„åˆå§‹åŒ–JSä»£ç &lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;function setupWebViewJavascriptBridge(callback) {
	if (window.WebViewJavascriptBridge) { 
	    return callback(WebViewJavascriptBridge); 
	}
	if (window.WVJBCallbacks) { 
	    return window.WVJBCallbacks.push(callback); 
	}
	window.WVJBCallbacks = [callback];
	var WVJBIframe = document.createElement('iframe');
	WVJBIframe.style.display = 'none';
	WVJBIframe.src = 'https://__bridge_loaded__';
	document.documentElement.appendChild(WVJBIframe);
	setTimeout(function() {
	    document.documentElement.removeChild(WVJBIframe)
	}, 0)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¯¥&lt;code class=&quot;highlighter-rouge&quot;&gt;setupWebViewJavascriptBridge&lt;/code&gt;å‡½æ•°ä¸»è¦æ˜¯é€šè¿‡åŠ¨æ€åœ¨WebViewä¸Šé¢åˆ›å»ºä¸€ä¸ªéšè—çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;iframe&lt;/code&gt;å®ç°åœ¨WebViewä¸Šé¢æ‰“å¼€&lt;code class=&quot;highlighter-rouge&quot;&gt;https://__bridge_loaded__&lt;/code&gt;è¿™æ ·çš„ä¸€ä¸ªé“¾æ¥åœ°å€ã€‚å…·ä½“çš„æµç¨‹åé¢çš„åˆ†æéƒ¨åˆ†ä¼šè¿›è¡Œä»‹ç»ã€‚&lt;/p&gt;

&lt;p&gt;åˆå§‹åŒ–å®Œæˆåå°±å¯ä»¥è¿›è¡ŒHandlerçš„æ³¨å†Œä¸è°ƒç”¨äº†&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;setupWebViewJavascriptBridge(function(bridge) {
	// æ³¨å†ŒJSç«¯çš„Handlerä¾›Nativeè¿›è¡Œè°ƒç”¨
	bridge.registerHandler('JS Echo', function(data, responseCallback) {
		console.log(&quot;JS Echo called with:&quot;, data)
		responseCallback(data)
	})
	// è°ƒç”¨Nativeç«¯æ³¨å†Œçš„Handler
	bridge.callHandler('ObjC Echo', {'key':'value'}, function responseCallback(responseData) {
		console.log(&quot;JS received response:&quot;, responseData)
	})
})
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;2nativeç«¯åˆå§‹åŒ–ä¸ä½¿ç”¨&quot;&gt;2ã€Nativeç«¯åˆå§‹åŒ–ä¸ä½¿ç”¨&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;self.bridge = [WebViewJavascriptBridge bridgeForWebView:webView];
// æ³¨å†ŒNativeç«¯çš„Handlerä¾›JSç«¯ä½¿ç”¨
[self.bridge registerHandler:@&quot;ObjC Echo&quot; handler:^(id data, WVJBResponseCallback responseCallback) {
	NSLog(@&quot;ObjC Echo called with: %@&quot;, data);
	responseCallback(data);
}];
// è°ƒç”¨JSç«¯æ³¨å†Œçš„Handler
[self.bridge callHandler:@&quot;JS Echo&quot; data:nil responseCallback:^(id responseData) {
	NSLog(@&quot;ObjC received response: %@&quot;, responseData);
}];
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;æºç åˆ†æ&quot;&gt;æºç åˆ†æ&lt;/h3&gt;

&lt;p&gt;WebViewJavascriptBridgeæ¡†æ¶ä¸»è¦æ˜¯Nativeå’ŒJavaScriptä¹‹é—´çš„åŒå‘äº¤äº’ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä»è¿™å‡ ä¸ªæ–¹é¢æ¥è¿›è¡Œåˆ†æï¼š&lt;/p&gt;

&lt;h4 id=&quot;1nativeæ³¨å†Œhandler&quot;&gt;1ã€Nativeæ³¨å†ŒHandler&lt;/h4&gt;

&lt;p&gt;Nativeç«¯æ³¨å†ŒHandlerå¯ä»¥ä¾›JavaScriptè¿›è¡Œè°ƒç”¨ï¼Œåœ¨Nativeç«¯æ³¨å†ŒHandlerçš„æ—¶å€™ä¼šè°ƒç”¨å¦‚ä¸‹çš„ä»£ç ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (void)registerHandler:(NSString *)handlerName handler:(WVJBHandler)handler {
    _base.messageHandlers[handlerName] = [handler copy];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ä»æºç æ¥çœ‹å…¶å®å°±æ˜¯åœ¨bridgeåˆå§‹åŒ–çš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;WebViewJavascriptBridgeBase&lt;/code&gt;çš„å®ä¾‹&lt;code class=&quot;highlighter-rouge&quot;&gt;_base&lt;/code&gt;ï¼Œæ³¨å†ŒHandlerå…¶å®å°±æ˜¯å°†Handlerå¤„ç†é€»è¾‘çš„blockä»£ç è®°å½•åˆ°&lt;code class=&quot;highlighter-rouge&quot;&gt;_base&lt;/code&gt;çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;messageHandlers&lt;/code&gt;é‡Œé¢ï¼Œè¯¥ç»“æ„æ˜¯ä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;NSMutableDictionary&lt;/code&gt;ã€‚åœ¨ä½¿ç”¨çš„æ—¶å€™ç›´æ¥é€šè¿‡Handlerçš„åå­—å°±å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„blockã€‚&lt;/p&gt;

&lt;h4 id=&quot;2javascriptæ³¨å†Œhandler&quot;&gt;2ã€JavaScriptæ³¨å†ŒHandler&lt;/h4&gt;

&lt;p&gt;JavaScriptç«¯æ³¨å†ŒHandlerçš„é€»è¾‘å’ŒNativeè¿™è¾¹å·®ä¸å¤šï¼Œä¹Ÿæ˜¯åœ¨å…¨å±€æœ‰ä¸€ä¸ªå¯¹è±¡è¿›è¡Œçš„è®°å½•ï¼Œå¯ä»¥ç†è§£ä¸ºå°±æ˜¯ä¸€ä¸ªå¯å˜çš„å­—å…¸ï¼Œè®°å½•äº†Handlerçš„åç§°å’Œå…·ä½“çš„å®ç°ä»£ç å›è°ƒã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;function registerHandler(handlerName, handler) {
    messageHandlers[handlerName] = handler;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;3nativeè°ƒç”¨javascriptçš„handler&quot;&gt;3ã€Nativeè°ƒç”¨JavaScriptçš„Handler&lt;/h4&gt;

&lt;p&gt;çœ‹å®Œäº†Native/JavaScriptç«¯çš„æ³¨å†ŒHandlerçš„é€»è¾‘ï¼Œæ¥ä¸‹æ¥çœ‹ä¸‹Nativeç«¯æ˜¯å¦‚ä½•è°ƒç”¨JavaScriptç«¯çš„Handlerçš„ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆä¼šè°ƒç”¨ä¸‹é¢çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;callHandler&lt;/code&gt;æ–¹æ³•ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (void)callHandler:(NSString *)handlerName {
    [self callHandler:handlerName data:nil responseCallback:nil];
}

- (void)callHandler:(NSString *)handlerName data:(id)data {
    [self callHandler:handlerName data:data responseCallback:nil];
}

- (void)callHandler:(NSString *)handlerName data:(id)data responseCallback:(WVJBResponseCallback)responseCallback {
    [_base sendData:data responseCallback:responseCallback handlerName:handlerName];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æœ€ç»ˆä¼šè°ƒç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;WebViewJavascriptBridgeBase&lt;/code&gt;çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;sendData...&lt;/code&gt;çš„æ–¹æ³•ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (void)sendData:(id)data responseCallback:(WVJBResponseCallback)responseCallback handlerName:(NSString*)handlerName {
    //æ„é€ æ¶ˆæ¯
    NSMutableDictionary* message = [NSMutableDictionary dictionary];
    //æ¶ˆæ¯ä½“
    if (data) {
        message[@&quot;data&quot;] = data;
    }
    //å›è°ƒ
    if (responseCallback) {
        NSString* callbackId = [NSString stringWithFormat:@&quot;objc_cb_%ld&quot;, ++_uniqueId]; //å›è°ƒçš„IDå”¯ä¸€æ ‡è¯†ç¬¦
        self.responseCallbacks[callbackId] = [responseCallback copy];
        message[@&quot;callbackId&quot;] = callbackId;
    }
    //handlerçš„åç§°
    if (handlerName) {
        message[@&quot;handlerName&quot;] = handlerName;
    }
    [self _queueMessage:message];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¯¥æ–¹æ³•å…ˆå°†ä¼ è¿›æ¥çš„å‚æ•°è¿›è¡Œå¤„ç†æ„é€ æˆä¸€æ¡æ¶ˆæ¯(message), æ¶ˆæ¯å¯ä»¥ç†è§£æˆæ˜¯ä¸€ä¸ªJSON:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{
	&quot;data&quot;: data /* å¿…é€‰ï¼Œå‘é€åˆ°JavaScriptç«¯çš„æ•°æ® */
	&quot;callbackId&quot;: &quot;objc_cb_xxxx&quot;, /* å¯é€‰ï¼Œå¦‚æœæœ‰å›è°ƒresponseCallbackä¼šå…¨å±€åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„å›è°ƒIDï¼Œå¹¶åœ¨responseCallbacksè®°ä¸‹æ¥å¯¹åº”çš„å…³ç³»*/
	&quot;handlerName&quot;: &quot;handlerName&quot; /* å¯é€‰ï¼Œhandlerçš„åç§°*/
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ¶ˆæ¯ç»“æ„æ„é€ å®Œæˆä¹‹åå°±è°ƒç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;_queueMessage&lt;/code&gt;æ–¹æ³•&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//WVJBMessage =&amp;gt; typedef NSDictionary WVJBMessage;
- (void)_queueMessage:(WVJBMessage *)message {
    //startupMessageQueueå¯åŠ¨bridgeçš„æ—¶å€™çš„åˆå§‹åŒ–çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œé»˜è®¤bridgeå¯åŠ¨å®Œæˆåä¼šè‡ªåŠ¨è°ƒç”¨å¹¶æ¸…ç©º
    if (self.startupMessageQueue) {
        [self.startupMessageQueue addObject:message];
    } 
    else {
        [self _dispatchMessage:message];
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å…ˆè·³è¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;startupMessageQueue&lt;/code&gt;ç›´æ¥çœ‹&lt;code class=&quot;highlighter-rouge&quot;&gt;_dispatchMessage&lt;/code&gt;, è¯¥æ–¹æ³•å°±æ˜¯å¤„ç†Nativeå‘å¾€JavaScriptç«¯çš„æ¶ˆæ¯çš„å…·ä½“å®ç°ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (void)_dispatchMessage:(WVJBMessage *)message {
    //å°†NSDictionaryè½¬åŒ–ä¸ºJSONå­—ç¬¦ä¸², å¹¶è½¬ä¹‰ä¸€äº›ç‰¹æ®Šçš„å­—ç¬¦
    NSString *messageJSON = [self _serializeMessage:message pretty:NO];
    [self _log:@&quot;SEND&quot; json:messageJSON];
    messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@&quot;\\&quot; withString:@&quot;\\\\&quot;];
    messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@&quot;\&quot;&quot; withString:@&quot;\\\&quot;&quot;];
    messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@&quot;\'&quot; withString:@&quot;\\\'&quot;];
    messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@&quot;\n&quot; withString:@&quot;\\n&quot;];
    messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@&quot;\r&quot; withString:@&quot;\\r&quot;];
    messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@&quot;\f&quot; withString:@&quot;\\f&quot;];
    messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@&quot;\u2028&quot; withString:@&quot;\\u2028&quot;]; //è¡Œåˆ†éš”ç¬¦
    messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@&quot;\u2029&quot; withString:@&quot;\\u2029&quot;]; //æ®µè½åˆ†éš”ç¬¦
    //æ‹¼æ¥è¦è°ƒç”¨çš„JavaScriptä»£ç ï¼Œå‚æ•°æ˜¯JSONå­—ç¬¦ä¸²
    NSString* javascriptCommand = [NSString stringWithFormat:@&quot;WebViewJavascriptBridge._handleMessageFromObjC('%@');&quot;, messageJSON];
    //åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹æ‰§è¡ŒJSä»£ç 
    if ([[NSThread currentThread] isMainThread]) {
        [self _evaluateJavascript:javascriptCommand];

    } 
    else {
        dispatch_sync(dispatch_get_main_queue(), ^{
            [self _evaluateJavascript:javascriptCommand];
        });
    }
}

// å°†NSDictionaryè½¬åŒ–ä¸ºJSONå­—ç¬¦ä¸², æ˜¯å¦æ˜¯å±•å¼€çš„æ ¼å¼
- (NSString *)_serializeMessage:(id)message pretty:(BOOL)pretty {
    return [[NSString alloc] initWithData:[NSJSONSerialization dataWithJSONObject:message options:(NSJSONWritingOptions)(pretty ? NSJSONWritingPrettyPrinted : 0) error:nil] encoding:NSUTF8StringEncoding];
}

// æ‰§è¡ŒJSä»£ç ï¼Œ å…¶å®æœ€ç»ˆè¿˜æ˜¯è°ƒç”¨çš„æ˜¯`stringByEvaluatingJavaScriptFromString`
- (void) _evaluateJavascript:(NSString *)javascriptCommand {
    //self.delegate =&amp;gt; WebViewJavascriptBridgeå¯¹è±¡çš„å®ä¾‹
    [self.delegate _evaluateJavascript:javascriptCommand];
}

- (NSString*) _evaluateJavascript:(NSString*)javascriptCommand {
    return [_webView stringByEvaluatingJavaScriptFromString:javascriptCommand];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆ°è¿™é‡ŒNativeå‘é€æ¶ˆæ¯åˆ°JavaScriptäº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çœ‹ä¸‹JavaScriptæ˜¯å¦‚ä½•æ¥æ”¶æ¶ˆæ¯ä¼šå“åº”çš„ï¼Œé¦–å…ˆä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºæ¥å‘é€æ¶ˆæ¯å…¶å®å°±æ˜¯åœ¨WebViewä¸Šé¢è°ƒç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;WebViewJavascriptBridge._handleMessageFromObjC&lt;/code&gt;è¿™ä¸ªJSçš„æ–¹æ³•ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªJSONå­—ç¬¦ä¸²ã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;function _handleMessageFromObjC(messageJSON) {
	_dispatchMessageFromObjC(messageJSON);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;_handleMessageFromObjC&lt;/code&gt;åœ¨JSç«¯çš„å®ç°å…¶å®æœ€ç»ˆè°ƒç”¨çš„æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;_dispatchMessageFromObjC&lt;/code&gt;è¿™ä¸ªå‡½æ•°ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;function _dispatchMessageFromObjC(messageJSON) {
    if (dispatchMessagesWithTimeoutSafety) {
        setTimeout(_doDispatchMessageFromObjC);
    } 
    else {
        _doDispatchMessageFromObjC();
    }
		
	function _doDispatchMessageFromObjC() {
		 // è§£ææ¶ˆæ¯çš„JSONå­—ç¬¦ä¸²
        var message = JSON.parse(messageJSON);
        var messageHandler;
        var responseCallback;
        
        if (message.responseId) {
        	  // å¯¹äºJavaScriptç«¯çš„æ¶ˆæ¯ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰responseIdè¿™ä¸ªå­—æ®µï¼Œè¡¨ç¤ºéœ€è¦è¿›è¡Œå›è°ƒå¤„ç†
            responseCallback = responseCallbacks[message.responseId];
            if (!responseCallback) {
                return;
            }
            responseCallback(message.responseData);
            delete responseCallbacks[message.responseId];
        } 
        else {
        	  // å¯¹äºNativeç«¯æ¥çš„æ¶ˆæ¯ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰callbackIdè¿™ä¸ªå­—æ®µï¼Œè¡¨ç¤ºéœ€è¦è¿›è¡Œå“åº”
            if (message.callbackId) {
                var callbackResponseId = message.callbackId;
                responseCallback = function(responseData) {
                    _doSend({handlerName: message.handlerName, responseId: callbackResponseId, responseData: responseData});
                };
            }
			  
			  // æ‰§è¡Œå¯¹åº”çš„Handler, è¿™ä¸ªå°±æ˜¯ä¹‹å‰JSç«¯æ³¨å†Œçš„Handlerçš„åç§°ï¼Œä»å…¨å±€çš„é…ç½®é‡Œé¢è·å–åˆ°å¯¹åº”çš„å‡½æ•°å®ç°
            var handler = messageHandlers[message.handlerName];
            if (!handler) {
                console.log(&quot;WebViewJavascriptBridge: WARNING: no handler for message from ObjC:&quot;, message);
            } 
            else {
            	   // è¿™é‡Œçš„handlerå…¶å®å°±æ˜¯å‰é¢æ³¨å†Œçš„handlerï¼Œæ‰§è¡Œå®Œæˆä¹‹åä¼šæ‰§è¡ŒresponseCallback
                handler(message.data, responseCallback);
            }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;responseCallback&lt;/code&gt;é‡Œé¢æœ€ç»ˆä¼šè°ƒç”¨ä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;_doSend&lt;/code&gt;æ–¹æ³•, è¯¥æ–¹æ³•ä¼šæŠŠæ¶ˆæ¯åŠ å…¥åˆ°æ¶ˆæ¯å‘é€é˜Ÿåˆ—é‡Œé¢ï¼Œç„¶åé€šè¿‡ä¿®æ”¹iframeçš„srcå±æ€§æ¥è¾¾åˆ°å‘Nativeç«¯å‘é€æ¶ˆæ¯çš„ç›®çš„ã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;function _doSend(message, responseCallback) {
    if (responseCallback) {
        var callbackId = 'cb_'+(uniqueId++)+'_'+new Date().getTime();
        responseCallbacks[callbackId] = responseCallback;
        message['callbackId'] = callbackId;
    }
    sendMessageQueue.push(message);
    messagingIframe.src = CUSTOM_PROTOCOL_SCHEME + '://' + QUEUE_HAS_MESSAGE;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;4javascriptè°ƒç”¨nativeçš„handler&quot;&gt;4ã€JavaScriptè°ƒç”¨Nativeçš„Handler&lt;/h4&gt;

&lt;p&gt;JavaScriptè°ƒç”¨Nativeçš„Handlerå°±ç›¸æ¯”ä¸Šé¢çš„ç®€å•ä¸€äº›äº†ï¼Œå°±æ˜¯ç›´æ¥è°ƒç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;_doSend&lt;/code&gt;æ–¹æ³•ï¼Œæ ¹æ®æ˜¯å¦æœ‰å›è°ƒå‡½æ•°ç„¶åæ‰§è¡Œå®Œæˆä¹‹åå°±ä»å…¨å±€çš„å›è°ƒé‡Œé¢æ‹¿å‡ºæ¥æ‰§è¡Œã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;function callHandler(handlerName, data, responseCallback) {
    if (arguments.length == 2 &amp;amp;&amp;amp; typeof data == 'function') {
        responseCallback = data;
        data = null;
    }
    _doSend({ handlerName:handlerName, data:data }, responseCallback);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;æ ¸å¿ƒé€»è¾‘&quot;&gt;æ ¸å¿ƒé€»è¾‘&lt;/h3&gt;

&lt;p&gt;ä¸Šé¢åªä»‹ç»äº†æ€ä¹ˆå‘é€å’Œæ€ä¹ˆæ¥æ”¶ï¼Œå…¶å®æœ€ç»ˆä¸»è¦æ˜¯å¦‚ä¸‹ä¸¤ä¸ªæ–¹é¢çš„å®ç°ï¼š&lt;/p&gt;

&lt;h4 id=&quot;1uiwebview---native&quot;&gt;1ã€UIWebView -&amp;gt; Native&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
    if (webView != _webView) { return YES; }
    NSURL *url = [request URL];
    __strong id&amp;lt;UIWebViewDelegate&amp;gt; strongDelegate = _webViewDelegate;
    if ([_base isWebViewJavascriptBridgeURL:url]) {
        if ([_base isBridgeLoadedURL:url]) {
            //__bridge_loaded__:// æ³¨å…¥JSä»£ç 
            [_base injectJavascriptFile];
        }
        else if ([_base isQueueMessageURL:url]) {
            //__wvjb_queue_message__:// æ¶ˆæ¯å¤„ç†
            NSString *messageQueueString = [self _evaluateJavascript:[_base webViewJavascriptFetchQueyCommand]];
            [_base flushMessageQueue:messageQueueString];
        }
        else {
            //æœªçŸ¥çš„æ¶ˆæ¯ç±»å‹
            [_base logUnkownMessage:url];
        }
        return NO;
    }
    else if (strongDelegate &amp;amp;&amp;amp; [strongDelegate respondsToSelector:@selector(webView:shouldStartLoadWithRequest:navigationType:)]) {
        return [strongDelegate webView:webView shouldStartLoadWithRequest:request navigationType:navigationType];
    }
    else {
        return YES;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆå§‹åŒ–çš„ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (void)injectJavascriptFile {
    NSString *js = WebViewJavascriptBridge_js();
    [self _evaluateJavascript:js];
    if (self.startupMessageQueue) {
        NSArray* queue = self.startupMessageQueue;
        self.startupMessageQueue = nil;
        for (id queuedMessage in queue) {
            [self _dispatchMessage:queuedMessage];
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;2native---uiwebview&quot;&gt;2ã€Native -&amp;gt; UIWebView&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (NSString*) _evaluateJavascript:(NSString *)javascriptCommand {
    return [_webView stringByEvaluatingJavaScriptFromString:javascriptCommand];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;å‚è€ƒèµ„æ–™&lt;/h3&gt;

&lt;p&gt;1ã€&lt;a href=&quot;https://github.com/marcuswestin/WebViewJavascriptBridge&quot;&gt;WebViewJavascriptBridgeä¸»é¡µ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2ã€&lt;a href=&quot;https://www.cnblogs.com/LeeGof/p/8143408.html&quot;&gt;WebViewJavascriptBridgeæµ…æ&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Sat, 18 Aug 2018 22:46:29 +0800</pubDate>
        <link>http://blog.devzeng.com/blog/ios-webviewjavascriptbridge-source.html</link>
        <guid isPermaLink="true">http://blog.devzeng.com/blog/ios-webviewjavascriptbridge-source.html</guid>
        
        <category>iOS</category>
        
        
      </item>
    
      <item>
        <title>å¦‚ä½•å°†macOSåº”ç”¨ç¨‹åºæ‰“åŒ…ä¸ºdmgæ–‡ä»¶</title>
        <description>&lt;p&gt;ä¹‹å‰æ”¹å†™è¿‡ç½‘ä¸Šå¼€æºçš„ä¸€ä¸ªJSONè½¬Modelçš„Mac APPï¼Œå½“æ—¶æ˜¯ç›´æ¥ä½¿ç”¨çš„æ˜¯å°†&lt;code class=&quot;highlighter-rouge&quot;&gt;.app&lt;/code&gt;æ ¼å¼çš„æ–‡ä»¶ç›´æ¥æ‹–åˆ°åº”ç”¨é‡Œé¢è¿›è¡Œå®‰è£…çš„ï¼Œæœ€è¿‘åˆšå¥½æœ‰ç©ºå°±äº†è§£äº†ä¸€ä¸‹dmgæ–‡ä»¶æ˜¯æ€ä¹ˆæ‰“åŒ…çš„ï¼Œè®°å½•ä¸‹æ•´ä¸ªçš„è¿‡ç¨‹æ–¹ä¾¿ä»¥åæŸ¥æ‰¾ã€‚&lt;/p&gt;

&lt;h3 id=&quot;æ“ä½œæ­¥éª¤&quot;&gt;æ“ä½œæ­¥éª¤&lt;/h3&gt;

&lt;h4 id=&quot;1å‡†å¤‡ç›¸å…³æ–‡ä»¶&quot;&gt;1.å‡†å¤‡ç›¸å…³æ–‡ä»¶&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;(1) æ‰“åŒ…ç”Ÿæˆçš„&lt;code class=&quot;highlighter-rouge&quot;&gt;.app&lt;/code&gt;æ–‡ä»¶&lt;/li&gt;
  &lt;li&gt;(2) ä¸€å¼ èƒŒæ™¯å›¾&lt;/li&gt;
  &lt;li&gt;(3) &lt;code class=&quot;highlighter-rouge&quot;&gt;Applications&lt;/code&gt;æ–‡ä»¶å¤¹çš„æ›¿èº«æ–‡ä»¶(å¯ä»¥åˆ°å…¶ä»–çš„dmgé‡Œé¢å»æ‹·è´ä¸€ä¸ª)&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;2åˆ›å»ºç©ºç™½é•œåƒæ–‡ä»¶&quot;&gt;2.åˆ›å»ºç©ºç™½é•œåƒæ–‡ä»¶&lt;/h4&gt;

&lt;p&gt;(1) æ‰“å¼€&lt;code class=&quot;highlighter-rouge&quot;&gt;ç£ç›˜å·¥å…·&lt;/code&gt;ï¼Œé€‰æ‹©&lt;code class=&quot;highlighter-rouge&quot;&gt;æ–‡ä»¶&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;æ–°å»ºæ˜ åƒ&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;ç©ºç™½æ˜ åƒ&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/macos-build-dmg-file/1.png&quot; alt=&quot;1.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(2) åœ¨å¼¹å‡ºæ¡†ä¸­å¡«å†™ç›¸å…³çš„ä¿¡æ¯&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/macos-build-dmg-file/2.png&quot; alt=&quot;2.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(3) å¡«å†™å®Œæˆåç‚¹å‡»ä¿å­˜ï¼Œå³å¯ç”Ÿæˆä¸€ä¸ªç©ºç™½çš„dmgæ–‡ä»¶&lt;/p&gt;

&lt;h4 id=&quot;3é…ç½®&quot;&gt;3.é…ç½®&lt;/h4&gt;

&lt;p&gt;(1) æ‹·è´æ–‡ä»¶&lt;/p&gt;

&lt;p&gt;åŒå‡»å‰é¢åˆ›å»ºçš„DMGæ–‡ä»¶ï¼Œåœ¨Finderä¸­æ‰“å¼€ï¼Œç›´æ¥å°†ä¹‹å‰å‡†å¤‡å¥½çš„ç›¸å…³æ–‡ä»¶æ‹–è¿›å»å°±è¡Œäº†&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/macos-build-dmg-file/3.png&quot; alt=&quot;3.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(2) è®¾ç½®èƒŒæ™¯å›¾ç‰‡å’Œå›¾æ ‡å¤§å°&lt;/p&gt;

&lt;p&gt;åœ¨æ‰“å¼€çš„é•œåƒæ–‡ä»¶ä¸­(Finder)çš„ç©ºç™½åœ°æ–¹å³é”®é€‰æ‹©&lt;code class=&quot;highlighter-rouge&quot;&gt;æŸ¥çœ‹æ˜¾ç¤ºé€‰é¡¹&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;1) è®¾ç½®å›¾æ ‡å¤§å°ä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;100*100&lt;/code&gt;ï¼ˆå…·ä½“å¯ä»¥æ ¹æ®å®é™…éœ€è¦è¿›è¡Œè°ƒæ•´)&lt;/p&gt;

&lt;p&gt;2ï¼‰è®¾ç½®èƒŒæ™¯ä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;å›¾ç‰‡&lt;/code&gt;ï¼Œå°†èƒŒæ™¯å›¾ç‰‡æ‹–åˆ°å³è¾¹çš„æ¡†é‡Œé¢&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/macos-build-dmg-file/8.png&quot; alt=&quot;8.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(3) éšè—èƒŒæ™¯å›¾ç‰‡&lt;/p&gt;

&lt;p&gt;éšè—èƒŒæ™¯å›¾ç‰‡æ–‡ä»¶å¤¹çš„æ–¹å¼å°±æ˜¯å°†å…¶é‡å‘½åä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;.&lt;/code&gt;å¼€å¤´çš„&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mv /Volumes/YoudaoNote_3.3.2/background /Volumes/YoudaoNote_3.3.2/.background
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æˆ–è€…æ˜¯&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;chflags hidden /Volumes/YoudaoNote_3.3.2/background
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(4) æ’åˆ—å›¾æ ‡&lt;/p&gt;

&lt;p&gt;ç›´æ¥æ‹–åŠ¨å›¾æ ‡åˆ°æŒ‡å®šä½ç½®ï¼Œæ‹–å®Œçš„æ•ˆæœå¦‚ä¸‹&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/macos-build-dmg-file/4.png&quot; alt=&quot;4.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(5) å…³é—­é•œåƒ&lt;/p&gt;

&lt;p&gt;æ‰“å¼€&lt;code class=&quot;highlighter-rouge&quot;&gt;ç£ç›˜å·¥å…·&lt;/code&gt;å°†å·¦ä¾§çš„å¯¹åº”çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;ç£ç›˜æ˜ åƒ&lt;/code&gt;å…³é—­å³å¯&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/macos-build-dmg-file/5.png&quot; alt=&quot;5.png&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;4è½¬æ¢&quot;&gt;4.è½¬æ¢&lt;/h4&gt;

&lt;p&gt;(1) æ‰“å¼€&lt;code class=&quot;highlighter-rouge&quot;&gt;ç£ç›˜å·¥å…·&lt;/code&gt;ï¼Œé€‰æ‹©&lt;code class=&quot;highlighter-rouge&quot;&gt;æ˜ åƒ&lt;/code&gt; -&amp;gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;è½¬æ¢&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/macos-build-dmg-file/6.png&quot; alt=&quot;6.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(2) å¡«å†™è¦ä¿å­˜çš„æ–‡ä»¶çš„åç§°ç‚¹å‡»è½¬æ¢å³å¯ï¼Œç”Ÿæˆçš„æ–‡ä»¶å°±æ˜¯æœ€ç»ˆçš„dmgæ–‡ä»¶&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/macos-build-dmg-file/7.png&quot; alt=&quot;7.png&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;å‚è€ƒèµ„æ–™&lt;/h3&gt;

&lt;p&gt;1ã€&lt;a href=&quot;https://www.jianshu.com/p/c6cd257676bf&quot;&gt;Mac OS å¼€å‘ ï¼ èŠèŠå¦‚ä½•æ‰“åŒ…dmgæ–‡ä»¶&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2ã€&lt;a href=&quot;https://bbs.feng.com/read-htm-tid-6724285.html&quot;&gt;åˆ¶ä½œæ˜ åƒ(dmg)æ–‡ä»¶è¯¦ç»†æ­¥éª¤&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Sat, 11 Aug 2018 11:46:29 +0800</pubDate>
        <link>http://blog.devzeng.com/blog/pack-macos-app-to-dmg.html</link>
        <guid isPermaLink="true">http://blog.devzeng.com/blog/pack-macos-app-to-dmg.html</guid>
        
        <category>macOS</category>
        
        
      </item>
    
      <item>
        <title>Pythonä½¿ç”¨pyexecjsæ‰§è¡ŒJSä»£ç </title>
        <description>&lt;p&gt;è¿‘æœŸåœ¨é‡‡é›†ä¸€ä¸ªç½‘ç«™çš„æ—¶å€™é‡åˆ°ä¸€éƒ¨åˆ†çš„é¡µé¢æ˜¯ä½¿ç”¨JSä»£ç æ¥å¡«å……æ•°æ®çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;tr&amp;gt;
    &amp;lt;td width=&quot;150px&quot; class=&quot;success&quot;&amp;gt;æ¡ˆä»¶çº§åˆ«:&amp;lt;/td&amp;gt;
    &amp;lt;td colspan=&quot;1&quot;&amp;gt;
        &amp;lt;script&amp;gt;
            var s = getDictLabel([{&quot;id&quot;:&quot;4191c4842b3842749dd467655f90b1fa&quot;,&quot;isNewRecord&quot;:false,&quot;remarks&quot;:&quot;æ¡ˆä»¶çº§åˆ«&quot;,&quot;createDate&quot;:&quot;2016-11-29 15:19:34&quot;,&quot;updateDate&quot;:&quot;2016-11-29 15:19:34&quot;,&quot;value&quot;:&quot;1&quot;,&quot;label&quot;:&quot;ä¸€èˆ¬äº‹ä»¶&quot;,&quot;type&quot;:&quot;case_grade&quot;,&quot;description&quot;:&quot;æ¡ˆä»¶çº§åˆ«&quot;,&quot;sort&quot;:1,&quot;parentId&quot;:&quot;0&quot;},{&quot;id&quot;:&quot;5e24fd12f3384f38ab10898013fe25d7&quot;,&quot;isNewRecord&quot;:false,&quot;createDate&quot;:&quot;2016-11-29 15:19:35&quot;,&quot;updateDate&quot;:&quot;2016-11-29 15:19:35&quot;,&quot;value&quot;:&quot;2&quot;,&quot;label&quot;:&quot;ç´§æ€¥äº‹ä»¶&quot;,&quot;type&quot;:&quot;case_grade&quot;,&quot;description&quot;:&quot;æ¡ˆä»¶çº§åˆ«&quot;,&quot;sort&quot;:2,&quot;parentId&quot;:&quot;0&quot;},{&quot;id&quot;:&quot;f793a78eb44c405b9fd007359df09579&quot;,&quot;isNewRecord&quot;:false,&quot;createDate&quot;:&quot;2016-11-29 15:19:36&quot;,&quot;updateDate&quot;:&quot;2016-11-29 15:19:36&quot;,&quot;value&quot;:&quot;3&quot;,&quot;label&quot;:&quot;ä¸€èˆ¬é‡å¤&quot;,&quot;type&quot;:&quot;case_grade&quot;,&quot;description&quot;:&quot;æ¡ˆä»¶çº§åˆ«&quot;,&quot;sort&quot;:3,&quot;parentId&quot;:&quot;0&quot;},{&quot;id&quot;:&quot;3f2605e3f6e648f688b79da5f730aedb&quot;,&quot;isNewRecord&quot;:false,&quot;createDate&quot;:&quot;2016-11-29 15:19:34&quot;,&quot;updateDate&quot;:&quot;2016-11-29 15:19:34&quot;,&quot;value&quot;:&quot;4&quot;,&quot;label&quot;:&quot;ç´§æ€¥é‡å¤&quot;,&quot;type&quot;:&quot;case_grade&quot;,&quot;description&quot;:&quot;æ¡ˆä»¶çº§åˆ«&quot;,&quot;sort&quot;:4,&quot;parentId&quot;:&quot;0&quot;}], 1, '', true);
            document.write(s);
        &amp;lt;/script&amp;gt;
    &amp;lt;/td&amp;gt;
    &amp;lt;td width=&quot;150px&quot; class=&quot;success&quot;&amp;gt;å—ç†æ—¶é—´:&amp;lt;/td&amp;gt;
    &amp;lt;td colspan=&quot;1&quot;&amp;gt;2018-08-05 13:39:22&amp;lt;/td&amp;gt;
&amp;lt;/tr&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¯¹ä¸Šä¸‹æ–‡çš„æºç è¿›è¡Œåˆ†æï¼Œæ‰¾åˆ°&lt;code class=&quot;highlighter-rouge&quot;&gt;getDictLabel&lt;/code&gt;è¿™ä¸ªJavaScriptçš„å‡½æ•°å®ç°ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;function getDictLabel(data, value, defaultValue){
	for (var i=0; i&amp;lt;data.length; i++){
		var row = data[i];
		if (row.value == value){
			return row.label;
		}
	}
	return defaultValue;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€šè¿‡ä¸€ç•ªäº†è§£ï¼Œå¯ä»¥è·å–åˆ°&lt;code class=&quot;highlighter-rouge&quot;&gt;td&lt;/code&gt;æ ‡ç­¾ä¸­é—´çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;script&lt;/code&gt;å¯¹åº”çš„JSä»£ç ï¼Œé€šè¿‡æ‰§è¡ŒJSä»£ç è·å–å¯¹åº”çš„æ•°æ®ã€‚æ‰¾åˆ°äº†ä¸€ä¸ªPythonçš„åº“&lt;code class=&quot;highlighter-rouge&quot;&gt;pyexecjs&lt;/code&gt;å¯ä»¥å®ç°ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç è¿›è¡Œå®‰è£…ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip install PyExecJS
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import execjs

def exec_js_function(js):
    # ç¼–è¯‘JSä»£ç 
    ctx = execjs.compile(&quot;&quot;&quot;
        function getDictLabel(data, value, defaultValue){
            for (var i = 0; i &amp;lt; data.length; i++){
                var row = data[i];
                if (row.value == value){
                    return row.label;
                }
            }
            return defaultValue;
        }
    &quot;&quot;&quot;)
    # åˆ é™¤ä¸€äº›æ— å…³çš„å­—ç¬¦
    jscode = js.replace('document.write(s);', '').replace(', true);', ')').replace('var s =', '')
    # æ‰§è¡Œä»£ç 
    return ctx.eval(jscode)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ›´å¤šç”¨æ³•å¯ä»¥ä»å‚è€ƒé“¾æ¥è·å–&lt;/p&gt;

&lt;h3 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;å‚è€ƒèµ„æ–™&lt;/h3&gt;

&lt;p&gt;1ã€&lt;a href=&quot;https://github.com/doloopwhile/PyExecJS&quot;&gt;å®˜æ–¹ä¸»é¡µ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2ã€&lt;a href=&quot;https://www.jianshu.com/p/729be9639ac7&quot;&gt;Pythonæ‰§è¡ŒJsè¯­å¥ä¹‹ExecJs&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;3ã€&lt;a href=&quot;http://www.wisedream.net/2017/11/27/traps/pyexecjs-and-pyv8/&quot;&gt;pyexecjsé€Ÿåº¦æ…¢ä¸pyv8çš„å®‰è£…&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 20 Jul 2018 11:46:29 +0800</pubDate>
        <link>http://blog.devzeng.com/blog/execute-js-code-with-execjs.html</link>
        <guid isPermaLink="true">http://blog.devzeng.com/blog/execute-js-code-with-execjs.html</guid>
        
        <category>Python</category>
        
        
      </item>
    
  </channel>
</rss>